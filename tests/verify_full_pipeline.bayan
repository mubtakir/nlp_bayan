hybrid {
    import ai.conceptual_orchestrator as orchestrator
    import ai.conceptual_surface_realizer as realizer

    print("Verifying Full Generative Pipeline...")

    # 1. Run a Meaning Program via Orchestrator
    print("\n--- Running Medical Treatment Program ---")
    control_msg = {
        "program_id": "medical_treatment",
        "detail_level": "medium",
        "focus": "causal"
    }
    
    result = orchestrator.dispatch_request(control_msg)
    
    if result["ok"]:
    {
        print("Program executed successfully.")
        components = result["components"]
        
        # 2. Manually bridge to Realizer (since Planner is not fully integrated yet)
        # We will construct a mock SurfacePlan for the 'treatment_causal' component
        
        if "treatment_causal" in components:
        {
            print("\n--- Realizing 'treatment_causal' Component ---")
            # The component has a trace, but we need to map it to a linear sequence.
            # For this test, we manually create the sequence based on the known circuit structure.
            # Circuit: Patient takes medicine -> Health improves
            
            # Arabic Plan
            plan_ar = {
                "sentence_type": "CausalSentence",
                "lang": "arabic",
                "sequence": [
                    {"concept_key": "action_take_medicine", "features": {"tense": "past", "person": "3ms"}}, # تناول
                    {"concept_key": "entity_patient", "features": {"definiteness": "def"}},                 # المريض
                    {"concept_key": "entity_medicine", "features": {"definiteness": "def"}},                # الدواء
                    {"symbol": "مما أدى إلى"},                                                              # causing
                    {"concept_key": "action_improve_health", "features": {"tense": "past", "person": "3ms"}} # تحسن
                ],
                "modifiers": {}
            }
            
            realization_ar = realizer.realize_from_surface_plan(plan_ar, "neutral")
            text_ar = realizer.realization_to_text(realization_ar)
            print("Arabic Output: " + text_ar)
            
            # English Plan
            plan_en = {
                "sentence_type": "CausalSentence",
                "lang": "english",
                "sequence": [
                    {"concept_key": "entity_patient", "features": {"definiteness": "def", "number": "singular"}}, # The patient
                    {"concept_key": "action_take_medicine", "features": {"tense": "past", "person": "3s"}},      # took
                    {"concept_key": "entity_medicine", "features": {"definiteness": "def"}},                      # the medicine
                    {"symbol": "causing"},                                                                        # causing
                    {"concept_key": "action_improve_health", "features": {"tense": "present", "person": "3s"}}    # health to improve (simplified)
                ],
                "modifiers": {}
            }
            
            realization_en = realizer.realize_from_surface_plan(plan_en, "neutral")
            text_en = realizer.realization_to_text(realization_en)
            print("English Output: " + text_en)
        }
    }
    else:
    {
        print("Error: " + result["error"])
    }

    print("\nVerification Complete.")
}
