/**
 * Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø­ÙˆØ§Ø±ÙŠ - Integrated Conversational AI
 * 
 * ÙŠØ±Ø¨Ø· Ø¬Ù…ÙŠØ¹ Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø­ÙˆØ§Ø±ÙŠ ÙÙŠ Ù†Ø¸Ø§Ù… ÙˆØ§Ø­Ø¯ Ù…ØªÙƒØ§Ù…Ù„
 * ÙŠØ¯ÙŠØ± ØªØ¯ÙÙ‚ Ø§Ù„Ø­ÙˆØ§Ø± Ù…Ù† Ø§Ù„Ù…Ø¯Ø®Ù„ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø®Ø±Ø¬
 * ÙŠÙˆÙØ± ÙˆØ§Ø¬Ù‡Ø© Ù…ÙˆØ­Ø¯Ø© Ù„Ù„ØªÙØ§Ø¹Ù„
 * 
 * @version 1.0.0
 * @author Baserah AI Team
 */

import { MotherEquation } from "../core/mother-equation.bn";
import { IntentAnalyzer, IntentAnalysisResult } from "./intent-analyzer.bn";
import { ResponsePlanner, ResponsePlan } from "./response-planner.bn";
import { TextGenerator, GenerationSettings, GenerationResult, WritingStyle, DetailLevel } from "./text-generator.bn";
import { FluencyEnhancer, EnhancementResult } from "./fluency-enhancer.bn";
import { DeepUnderstandingSystem, DeepUnderstandingResult } from "./deep-understanding.bn";
import { ConversationalLearningSystem, FeedbackType } from "./conversational-learning.bn";

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„ØªØ¹Ø¯Ø§Ø¯Ø§Øª - Enumerations
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
 */
export enum SystemState {
    IDLE = "IDLE",                  // Ø®Ø§Ù…Ù„
    PROCESSING = "PROCESSING",      // ÙŠØ¹Ø§Ù„Ø¬
    RESPONDING = "RESPONDING",      // ÙŠØ³ØªØ¬ÙŠØ¨
    LEARNING = "LEARNING",          // ÙŠØªØ¹Ù„Ù…
    ERROR = "ERROR"                 // Ø®Ø·Ø£
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Ø§Ù„ÙØ¦Ø§Øª - Classes
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

/**
 * Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù…
 */
export class SystemSettings extends MotherEquation {
    writingStyle: WritingStyle;
    detailLevel: DetailLevel;
    enableLearning: boolean;
    enableDeepUnderstanding: boolean;
    enableFluencyEnhancement: boolean;
    maxResponseLength: number;

    constructor(id: string = "system-settings-001") {
        super(id);
        this.writingStyle = WritingStyle.FRIENDLY;
        this.detailLevel = DetailLevel.MODERATE;
        this.enableLearning = true;
        this.enableDeepUnderstanding = true;
        this.enableFluencyEnhancement = true;
        this.maxResponseLength = 500;
    }
}

/**
 * Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©
 */
export class ProcessingResult extends MotherEquation {
    userInput: string;
    intentAnalysis: IntentAnalysisResult;
    deepUnderstanding: DeepUnderstandingResult | null;
    responsePlan: ResponsePlan;
    generationResult: GenerationResult;
    enhancementResult: EnhancementResult | null;
    finalResponse: string;
    processingTime: number;
    timestamp: number;

    constructor(id: string, userInput: string) {
        super(id);
        this.userInput = userInput;
        this.intentAnalysis = null;
        this.deepUnderstanding = null;
        this.responsePlan = null;
        this.generationResult = null;
        this.enhancementResult = null;
        this.finalResponse = "";
        this.processingTime = 0;
        this.timestamp = Date.now();
    }

    /**
     * ØªÙˆÙ„ÙŠØ¯ ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„
     */
    generateReport(): string {
        let report = "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n";
        report += "ğŸ¤– ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø©\n";
        report += "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n";

        report += `ğŸ‘¤ Ø§Ù„Ù…Ø¯Ø®Ù„: "${this.userInput}"\n`;
        report += `ğŸ¤– Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: "${this.finalResponse}"\n\n`;

        report += `â±ï¸ ÙˆÙ‚Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©: ${this.processingTime}ms\n`;
        report += `ğŸ“… Ø§Ù„ÙˆÙ‚Øª: ${new Date(this.timestamp).toLocaleString("ar-EG")}\n\n`;

        if (this.intentAnalysis) {
            report += `ğŸ¯ Ø§Ù„Ù†ÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©: ${this.intentAnalysis.primaryIntent.type}\n`;
            report += `ğŸ“Š Ø§Ù„Ø«Ù‚Ø©: ${(this.intentAnalysis.overallConfidence * 100).toFixed(1)}%\n\n`;
        }

        if (this.deepUnderstanding) {
            if (this.deepUnderstanding.emotionAnalysis) {
                report += `ğŸ˜Š Ø§Ù„Ù…Ø´Ø§Ø¹Ø±: ${this.deepUnderstanding.emotionAnalysis.primaryEmotion}\n`;
            }
            if (this.deepUnderstanding.toneAnalysis) {
                report += `ğŸµ Ø§Ù„Ù†Ø¨Ø±Ø©: ${this.deepUnderstanding.toneAnalysis.primaryTone}\n`;
            }
            report += "\n";
        }

        if (this.responsePlan) {
            report += `ğŸ“‹ Ù†ÙˆØ¹ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©: ${this.responsePlan.responseType}\n`;
            report += `ğŸ“Š Ø§Ù„Ø§Ø³ØªØ±Ø§ØªÙŠØ¬ÙŠØ©: ${this.responsePlan.strategy}\n\n`;
        }

        if (this.enhancementResult && this.enhancementResult.appliedEnhancements.length > 0) {
            report += `âœ¨ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª: ${this.enhancementResult.appliedEnhancements.length}\n`;
            report += `ğŸ“ˆ Ø¯Ø±Ø¬Ø© Ø§Ù„ØªØ­Ø³ÙŠÙ†: ${(this.enhancementResult.improvementScore * 100).toFixed(1)}%\n`;
        }

        return report;
    }
}

/**
 * Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø­ÙˆØ§Ø±ÙŠ
 */
export class IntegratedConversationalAI extends MotherEquation {
    // Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
    private intentAnalyzer: IntentAnalyzer;
    private responsePlanner: ResponsePlanner;
    private textGenerator: TextGenerator;
    private fluencyEnhancer: FluencyEnhancer;
    private deepUnderstanding: DeepUnderstandingSystem;
    private learningSystem: ConversationalLearningSystem;

    // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
    private settings: SystemSettings;

    // Ø§Ù„Ø­Ø§Ù„Ø©
    private state: SystemState;

    // Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø§Øª
    private processingHistory: ProcessingResult[];

    // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
    private stats: {
        totalProcessed: number;
        averageProcessingTime: number;
        successRate: number;
    };

    constructor(id: string = "integrated-conversational-ai-001") {
        super(id);

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª
        this.intentAnalyzer = new IntentAnalyzer("intent-analyzer");
        this.responsePlanner = new ResponsePlanner("response-planner");
        this.textGenerator = new TextGenerator("text-generator");
        this.fluencyEnhancer = new FluencyEnhancer("fluency-enhancer");
        this.deepUnderstanding = new DeepUnderstandingSystem("deep-understanding");
        this.learningSystem = new ConversationalLearningSystem("learning-system");

        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
        this.settings = new SystemSettings();

        // Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
        this.state = SystemState.IDLE;

        // Ø§Ù„Ø³Ø¬Ù„
        this.processingHistory = [];

        // Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        this.stats = {
            totalProcessed: 0,
            averageProcessingTime: 0,
            successRate: 1.0
        };
    }

    /**
     * Ù…Ø¹Ø§Ù„Ø¬Ø© Ù…Ø¯Ø®Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
     */
    process(userInput: string): ProcessingResult {
        let startTime = Date.now();
        this.state = SystemState.PROCESSING;

        let result = new ProcessingResult(
            `processing-${Date.now()}`,
            userInput
        );

        try {
            // 1. ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ù†ÙŠØ©
            result.intentAnalysis = this.intentAnalyzer.analyze(userInput);

            // 2. Ø§Ù„ÙÙ‡Ù… Ø§Ù„Ø¹Ù…ÙŠÙ‚ (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØ¹Ù„Ø§Ù‹)
            if (this.settings.enableDeepUnderstanding) {
                result.deepUnderstanding = this.deepUnderstanding.analyze(result.intentAnalysis);
            }

            // 3. ØªØ®Ø·ÙŠØ· Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©
            result.responsePlan = this.responsePlanner.createPlan(result.intentAnalysis);

            // 4. ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù†Øµ
            this.state = SystemState.RESPONDING;
            
            let generationSettings = new GenerationSettings("gen-settings");
            generationSettings.style = this.settings.writingStyle;
            generationSettings.detailLevel = this.settings.detailLevel;
            generationSettings.maxLength = this.settings.maxResponseLength;

            result.generationResult = this.textGenerator.generate(
                result.responsePlan.responseType,
                result.responsePlan.getRequiredData(),
                generationSettings
            );

            // 5. ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø·Ù„Ø§Ù‚Ø© (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØ¹Ù„Ø§Ù‹)
            if (this.settings.enableFluencyEnhancement) {
                result.enhancementResult = this.fluencyEnhancer.enhance(
                    result.generationResult.generatedText,
                    this.settings.writingStyle
                );
                result.finalResponse = result.enhancementResult.enhancedText;
            } else {
                result.finalResponse = result.generationResult.generatedText;
            }

            // 6. Ø§Ù„ØªØ¹Ù„Ù… (Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙØ¹Ù„Ø§Ù‹)
            if (this.settings.enableLearning) {
                this.state = SystemState.LEARNING;
                this.learningSystem.addMessage("user", userInput);
                this.learningSystem.addMessage("system", result.finalResponse);
            }

            // Ø­Ø³Ø§Ø¨ ÙˆÙ‚Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
            result.processingTime = Date.now() - startTime;

            // Ø­ÙØ¸ ÙÙŠ Ø§Ù„Ø³Ø¬Ù„
            this.processingHistory.push(result);

            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
            this.updateStats(result, true);

            this.state = SystemState.IDLE;

        } catch (error) {
            this.state = SystemState.ERROR;
            result.finalResponse = "Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨Ùƒ.";
            result.processingTime = Date.now() - startTime;
            
            this.updateStats(result, false);
        }

        return result;
    }

    /**
     * Ø¨Ø¯Ø¡ Ù…Ø­Ø§Ø¯Ø«Ø© Ø¬Ø¯ÙŠØ¯Ø©
     */
    startConversation(topic: string = "general"): void {
        if (this.settings.enableLearning) {
            this.learningSystem.startConversation(topic);
        }
    }

    /**
     * Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
     */
    endConversation(): void {
        if (this.settings.enableLearning) {
            this.learningSystem.endConversation();
        }
    }

    /**
     * Ø¥Ø¶Ø§ÙØ© Ø±Ø¯Ø© ÙØ¹Ù„
     */
    addFeedback(
        messageId: string,
        feedbackType: FeedbackType,
        score: number,
        comment: string = ""
    ): void {
        if (this.settings.enableLearning) {
            this.learningSystem.addFeedback(messageId, feedbackType, score, comment);
        }
    }

    /**
     * ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
     */
    updateSettings(settings: Partial<SystemSettings>): void {
        if (settings.writingStyle !== undefined) {
            this.settings.writingStyle = settings.writingStyle;
        }
        if (settings.detailLevel !== undefined) {
            this.settings.detailLevel = settings.detailLevel;
        }
        if (settings.enableLearning !== undefined) {
            this.settings.enableLearning = settings.enableLearning;
        }
        if (settings.enableDeepUnderstanding !== undefined) {
            this.settings.enableDeepUnderstanding = settings.enableDeepUnderstanding;
        }
        if (settings.enableFluencyEnhancement !== undefined) {
            this.settings.enableFluencyEnhancement = settings.enableFluencyEnhancement;
        }
        if (settings.maxResponseLength !== undefined) {
            this.settings.maxResponseLength = settings.maxResponseLength;
        }
    }

    /**
     * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©
     */
    getSettings(): SystemSettings {
        return this.settings;
    }

    /**
     * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø­Ø§Ù„Ø© Ø§Ù„Ù†Ø¸Ø§Ù…
     */
    getState(): SystemState {
        return this.state;
    }

    /**
     * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø§Øª
     */
    getHistory(limit: number = 10): ProcessingResult[] {
        return this.processingHistory.slice(-limit);
    }

    /**
     * ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
     */
    private updateStats(result: ProcessingResult, success: boolean): void {
        this.stats.totalProcessed++;

        // ØªØ­Ø¯ÙŠØ« Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
        let total = this.stats.averageProcessingTime * (this.stats.totalProcessed - 1);
        total += result.processingTime;
        this.stats.averageProcessingTime = total / this.stats.totalProcessed;

        // ØªØ­Ø¯ÙŠØ« Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­
        let totalSuccess = this.stats.successRate * (this.stats.totalProcessed - 1);
        if (success) {
            totalSuccess++;
        }
        this.stats.successRate = totalSuccess / this.stats.totalProcessed;
    }

    /**
     * Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
     */
    getStats(): any {
        return {
            totalProcessed: this.stats.totalProcessed,
            averageProcessingTime: this.stats.averageProcessingTime.toFixed(1) + "ms",
            successRate: (this.stats.successRate * 100).toFixed(1) + "%",
            currentState: this.state,
            
            // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª
            intentAnalyzer: this.intentAnalyzer.getStats(),
            responsePlanner: this.responsePlanner.getStats(),
            textGenerator: this.textGenerator.getStats(),
            fluencyEnhancer: this.fluencyEnhancer.getStats(),
            deepUnderstanding: this.deepUnderstanding.getStats(),
            learningSystem: this.learningSystem.getStats()
        };
    }

    /**
     * ØªÙˆÙ„ÙŠØ¯ ØªÙ‚Ø±ÙŠØ± Ø´Ø§Ù…Ù„
     */
    generateSystemReport(): string {
        let report = "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n";
        report += "ğŸ¤– ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„ Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø­ÙˆØ§Ø±ÙŠ\n";
        report += "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n";

        report += `ğŸ“Š Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø¹Ø§Ù…Ø©:\n`;
        report += `   - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø§Øª: ${this.stats.totalProcessed}\n`;
        report += `   - Ù…ØªÙˆØ³Ø· ÙˆÙ‚Øª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©: ${this.stats.averageProcessingTime.toFixed(1)}ms\n`;
        report += `   - Ù…Ø¹Ø¯Ù„ Ø§Ù„Ù†Ø¬Ø§Ø­: ${(this.stats.successRate * 100).toFixed(1)}%\n`;
        report += `   - Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©: ${this.state}\n\n`;

        report += `âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª:\n`;
        report += `   - Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„ÙƒØªØ§Ø¨Ø©: ${this.settings.writingStyle}\n`;
        report += `   - Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªÙØ§ØµÙŠÙ„: ${this.settings.detailLevel}\n`;
        report += `   - Ø§Ù„ØªØ¹Ù„Ù…: ${this.settings.enableLearning ? "Ù…ÙØ¹Ù„" : "Ù…Ø¹Ø·Ù„"}\n`;
        report += `   - Ø§Ù„ÙÙ‡Ù… Ø§Ù„Ø¹Ù…ÙŠÙ‚: ${this.settings.enableDeepUnderstanding ? "Ù…ÙØ¹Ù„" : "Ù…Ø¹Ø·Ù„"}\n`;
        report += `   - ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø·Ù„Ø§Ù‚Ø©: ${this.settings.enableFluencyEnhancement ? "Ù…ÙØ¹Ù„" : "Ù…Ø¹Ø·Ù„"}\n\n`;

        report += `ğŸ§© Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª:\n\n`;

        report += `   ğŸ“ Ù…Ø­Ù„Ù„ Ø§Ù„Ù†ÙˆØ§ÙŠØ§:\n`;
        let intentStats = this.intentAnalyzer.getStats();
        report += `      - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª: ${intentStats.totalAnalyses}\n`;
        report += `      - Ù…ØªÙˆØ³Ø· Ø§Ù„Ø«Ù‚Ø©: ${intentStats.averageConfidence}\n\n`;

        report += `   ğŸ“‹ Ù…Ø®Ø·Ø· Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø©:\n`;
        let plannerStats = this.responsePlanner.getStats();
        report += `      - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®Ø·Ø·: ${plannerStats.totalPlans}\n`;
        report += `      - Ù…ØªÙˆØ³Ø· Ø§Ù„Ù…ÙƒÙˆÙ†Ø§Øª: ${plannerStats.averageComponents}\n\n`;

        report += `   âœï¸ Ù…ÙˆÙ„Ø¯ Ø§Ù„Ù†ØµÙˆØµ:\n`;
        let generatorStats = this.textGenerator.getStats();
        report += `      - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªÙˆÙ„ÙŠØ¯Ø§Øª: ${generatorStats.totalGenerations}\n`;
        report += `      - Ù…ØªÙˆØ³Ø· Ø§Ù„Ø·ÙˆÙ„: ${generatorStats.averageLength}\n\n`;

        if (this.settings.enableFluencyEnhancement) {
            report += `   âœ¨ Ù…Ø­Ø³Ù† Ø§Ù„Ø·Ù„Ø§Ù‚Ø©:\n`;
            let enhancerStats = this.fluencyEnhancer.getStats();
            report += `      - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª: ${enhancerStats.totalEnhancements}\n`;
            report += `      - Ù…ØªÙˆØ³Ø· Ø§Ù„ØªØ­Ø³ÙŠÙ†: ${enhancerStats.averageImprovement}\n\n`;
        }

        if (this.settings.enableDeepUnderstanding) {
            report += `   ğŸ§  Ø§Ù„ÙÙ‡Ù… Ø§Ù„Ø¹Ù…ÙŠÙ‚:\n`;
            let deepStats = this.deepUnderstanding.getStats();
            report += `      - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª: ${deepStats.totalAnalyses}\n\n`;
        }

        if (this.settings.enableLearning) {
            report += `   ğŸ“š Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ù„Ù…:\n`;
            let learningStats = this.learningSystem.getStats();
            report += `      - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø§Øª: ${learningStats.totalConversations}\n`;
            report += `      - Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±Ø³Ø§Ø¦Ù„: ${learningStats.totalMessages}\n`;
            report += `      - Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø¶Ø§: ${learningStats.averageSatisfaction}\n`;
            report += `      - Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ù…ÙƒØªØ´ÙØ©: ${learningStats.totalPatterns}\n`;
            report += `      - Ø§Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„Ù…ÙƒØªØ³Ø¨Ø©: ${learningStats.totalKnowledge}\n`;
        }

        return report;
    }
}

