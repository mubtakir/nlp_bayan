## RFC: "المترادفات/التقارب" كميزة أساسية في لغة البيان (Synonyms/Similarity as a Core Feature)

الغرض: جعل مفهوم "المترادفات/التقارب" كائناً من الدرجة الأولى في البيان، بحيث يخدم مجالات متعددة (اللغة الطبيعية، الكيمياء، الفيزياء، الهندسة، علم النفس...) ولا يقتصر على NLP.

الفكرة الجوهرية: تعريف كيان مفاهيمي (شيء/كلمة/مفهوم/تفاعل/حالة...) مع قائمة عناصر قريبة منه بدرجات قرابة [0..1]، وقيمة افتراضية 0.7 عند عدم التصريح، مع واجهات منطقية وإجرائية موحّدة للاستعلام والاستخدام.

---

### 1) الصياغة العليا (DSL) المقترحة

- شكل عام محايد: "المفهوم(...)" أو "الشيء(...)" حيث يُمرَّر عناصر مع درجات القرابة
  - مثال لغوي:
    - أسد(غضنفر: 0.8، هيضم: 0.5)
    - القيمة الافتراضية عند الإغفال: 0.7
  - أمثلة غير لغوية:
    - ناتج_كيميائي(تفاعلA: 0.9، تفاعلB: 0.6)
    - صوت(طنين: 0.8، أزيز: 0.5)

- بديل صريح بالإنجليزية داخل البيان لتوحيد المفهوم:
  - synset "أسد": { "غضنفر": 0.8, "هيضم": 0.5 } default 0.7
  - synrel "أسد" ~ "غضنفر" @ 0.8 kind: "syn" domain: "lexicon"

ملاحظة: اختيار اسم الـ DSL النهائي (الشيء/المفهوم/الكلمة/synset) قرار تصميمي؛ المهم أن تكون البنية عامة وليست محصورة بنطاق لغوي.

---

### 2) الدلالات المنطقية (Facts/Predicates)

- حقائق أساسية قياسية تُستولد من الـ DSL (ثنائية الاتجاه افتراضاً):
  - similar(X, Y, Score, Kind="syn", Domain="")
  - synonym(X, Y, Score) سكر لمكافئ: similar(X, Y, Score, "syn", "lexicon")
  - threshold("syn", 0.7) قيمة افتراضية عامة يمكن تعديلها (مثل منظومة prob/threshold)

- استعلامات قياسية:
  - close(X, Y, Tau=default) ⇐ True إذا وُجدت similar(X,Y,Score,Kind) وScore ≥ Tau
  - nearest(X, N, Kind=\"syn\") ⇐ أعلى N عناصر حسب الدرجة
  - canon(X) ⇐ يعيد الممثل/المفهوم المرجعي إذا تم إعلان "مفهوم" جامع (اختياري)

---

### 3) واجهات الإجرائي-المنطقي (Interop)

- في الكود الإمبراطوري داخل hybrid:
  - exists similar("أسد", W, s, "syn", _)
  - first similar("أسد", W, s, "syn", _)
  - collect similar(W1, W2, s, kind)
- عامل تقارب/مساواة تقريبية (اختياري) للاختبارات:
  - X ≈τ Y  ⇐ close(X, Y, τ)

---

### 4) نطاقات/مجالات (Domains) وأنواع التقارب (Kinds)

- Domain: lexicon / chemistry / physics / psychology / engineering / ...
- Kind: syn (مترادفات لغوية)، approx_eq (تقارب عددي/وحدات)، pathway (مسارات تؤدي لناتج واحد)، alias (مسميات)، pattern (تشابه نمطي)...
- هذا الفصل يمكّن من إعادة استخدام نفس البنية عبر حقول معرفية مختلفة دون خلط المعاني.

---

### 5) الاستخدامات الميدانية

- NLP:
  - الكلمة(مرادف1:0.8، مرادف2:0.5، ...)، توسيع مرشّحات التوليد/الفهم بالقرابة
  - دعم البحث/التطبيع الدلالي/تحسين التغطية في KB
- الكيمياء:
  - الناتج(تفاعلA:0.9، تفاعلB:0.6) لتمثيل مسارات بديلة تقود لنفس الناتج مع أوزان ثقة
- الفيزياء/الهندسة:
  - approx_eq("1L","1000mL":1.0) أو وحدة(نيوتن:1.0، كجم·م/ث²:1.0)
- علم النفس/الاجتماع:
  - سلوك(اندفاع:0.6، مبادرة:0.5) مع Domain="behavior"

---

### 6) التكامل مع محرّك المنطق والتوليد

- استبدال/تعزيز المرشحين:
  - cand_pool = expand_by_similar(seed, tau) عند الحاجة
  - boost_by_similar(target, weight_fn(score)) داخل dist(...)
- توسيع التطابق في القواعد:
  - rule X :- similar(X, Y, s, kind), base_rule(Y)
- التطبيع نحو ممثلٍ مرجعي (canon) للحفاظ على هوية واحدة في KB عند التخزين.

---

### 7) واجهة توزيعات قياسية (تكامل اختياري)

- dist({...}).boost(lambda w: close(w, ref, tau), factor)
- nucleus/temperature بعد دمج المرشحين المتقاربين
- trace موحّد يوضّح: المصدر (similar/syn)، الدرجة، كيف أثّر التعزيز

---

### 8) الصياغة المقترحة (أمثلة)

- تعريف سريع بنمط عربي:
```
أسد(غضنفر:0.8، هيضم:0.5)  # default 0.7 عند الإغفال
```
- استعلام منطقي مباشر:
```
? close("أسد", "غضنفر")        # يستخدم threshold("syn",0.7)
? close("أسد", "هيضم", 0.4)     # True لأن 0.5 ≥ 0.4
```
- بنمط synset الإنجليزي:
```
synset "أسد": { "غضنفر":0.8, "هيضم":0.5 } default 0.7
similar("أسد","غضنفر",0.8,"syn","lexicon")
```
- عامل تقارب (إن أُدخل للغة):
```
if ("أسد" ≈0.7 "غضنفر"): { ... }
```

---

### 9) اعتبارات التصميم والتنفيذ المرحلي

- المرحلة 1 (سهلة وعالية الأثر):
  - facts: similar/4 + synonym/3 + threshold("syn",0.7)
  - استعلامات: close/nearest/canon
  - Sugar DSL: synset ... default 0.7
- المرحلة 2:
  - عامل ≈τ اختياري على مستوى اللغة
  - تكامل dist(...).boost(...) + trace موحّد
- المرحلة 3:
  - دعم Domains/Kinds موسّع + استيراد/تبادل مصادر خارجية
  - API للاستيراد من جداول/嵌نصوص/嵌نواقل متجهية (اختياري لاحقًا)

ملاحظات أمان/أداء:
- التماثل: similar(X,Y,...) يُخزَّن/يُستنتج متناظراً (Y,X)
- لا ننصح بتراكيب إغلاق تعدّيّة تلقائية (transitive closure) على الدرجات دون ضبط؛ تُترك للطبقة التطبيقية.
- التخزين بنطاق/مجال domain لحماية اتساق المعنى.

---

### 10) لماذا داخل البيان نفسه؟
- لأنه نمط مجرد يتكرر عبر مجالات عديدة؛ جعله كياناً أساسياً يقلل كلفة البناء ويزيد التركيبية.
- يسمح بجسر واضح بين المنطق والتشابه/القرابة والاختيار الاحتمالي.
- يبسط كتابة القواعد والتوليد والفهم والبحث، ويُوحّد الواجهات.

(هذه وثيقة تصميم أولية؛ التفاصيل النهائية تُحسم بتجارب صغيرة واختبارات، مع الحفاظ على التوافق العكسي.)

