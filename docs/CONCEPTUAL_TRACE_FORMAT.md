# تنسيق الأثر التصوّري (Conceptual Trace Format)

## 1. الهدف

هذا المستند يعرّف **تنسيقًا عامًا للأثر التصوّري** الذي يمثّل:

- مخرجات طبقة الكيانات/الوجود + الديناميكيات التصوّرية،
- ومدخلات طبقة الجسر التصوّري–اللغوي والنموذج اللغوي.

الهدف هو توفير **واجهة معيارية** يستطيع المبرمج أن يملأها من أي مجال (علمي، اجتماعي، نفسي، قانوني، ...)، بينما تبقى طبقة اللغة والتوليد مستقلة عن تفاصيل المجال.

---

## 2. المبادئ العامة

1. الأثر التصوّري **غير لغوي** في الجوهر:
   - لا يعتمد على كلمات بعينها، بل على معرفات كيانات، أفعال، خصائص، مجالات.
2. الأثر التصوّري **احتمالي / تشكيكي**:
   - يدعم درجات مشاركة، درجات يقين، وقيم حالات/خصائص في [0..1] أو أنواع أخرى (numeric/bounded).
3. الأثر التصوّري **زمني**:
   - يحترم ترتيب الأحداث والتغيّرات، ويمكن استعماله لاحقًا للرسم الزمني أو السرد.
4. الأثر التصوّري **قابل للاستعلام المنطقي**:
   - يمكن تحويله بسهولة إلى حقائق منطقية (`entity/1`, `state/3`, `event/4`, `changed/4`, ...)، أو البناء فوقها.

---

## 3. المكوّنات الرئيسة للأثر التصوّري

نقترح أن يتكوّن الأثر التصوّري من الهيكل المفاهيمي التالي (تجريديًا):

- `entities`  — الكيانات النشطة في المشهد.
- `states`    — الحالات والخصائص لكل كيان في لحظات مختلفة.
- `events`    — الأفعال/الأحداث المؤثّرة مع ترتيب زمني.
- `transforms` — التغيّرات المجمّعة للحالات/الخصائص.
- `ideas`     — (اختياري) تجميعات عليا لكيانات + حدث + نتيجة.
- `meta`      — معلومات سياقية (مجال، بيئة، زمن، مصدر، ثقة، ...).

هذا الهيكل يمكن تمثيله داخل بيان بمكتبة أو نوع مُعرّف من قبل المستخدم، أو بصيغ بيانات (قوائم، قواميس، حقائق منطقية).

---

## 4. وصف المكوّنات

### 4.1 الكيانات (entities)

كل كيان نشط في المشهد يمثَّل بمواصفات عامة مثل:

- معرف عام: `id`
- نوع مفاهيمي: `kind` (على مستوى المجال، لا على مستوى اللغة الطبيعية)
- مجال وبيئة: `domain`, `environment`
- خصائص شبه ثابتة: `properties`

بصيغة مفاهيمية يمكن تخيّل سجل كيان من النوع:

- `id`: معرف رمزي مجرد (مثلاً: `e1`, `agent_A`, ...)
- `kind`: اسم نوع مفاهيمي (مثلاً: `agent`, `object`, `resource`, `process`)
- `domain`: معرف المجال (مثلاً: `life_domain`, `physics_domain`)
- `environment`: معرف البيئة داخل المجال
- `properties`: قاموس خصائص شبه ثابتة (قد تحتوي قيمًا نوعية أو عددية)

### 4.2 الحالات والخصائص (states)

الحالات تمثّل **القيم المتغيّرة** للكيان مع الزمن، خاصة القيم الضبابية [0..1] أو الأضداد.

شكل عام لكل إدخال حالة:

- `entity_id`: معرف الكيان
- `name`: اسم الحالة/الخاصية (مجرد عن اللغة الطبيعية)
- `value`: القيمة (غالبًا [0..1]، أو نوع آخر عند الحاجة)
- `time`: مؤشر زمني أو مرحلة (قبل/بعد/أثناء)
- `certainty`: درجة اليقين (اختياري)

يمكن ربط هذا مباشرة بما يقدّمه محرك الكيانات من حقائق `state/3` و `property/3`.

### 4.3 الأحداث (events)

الأحداث تمثّل الأفعال أو العمليات التي تؤثّر في الحالات/الخصائص.

لكل حدث عام:

- `id`: معرف الحدث
- `action`: معرف الفعل (مجرّد عن اللغة الطبيعية)
- `actors`: قائمة مشاركين (كيان + دور + درجة مشاركة)
- `targets`: قائمة متأثرين (كيان + دور)
- `domain` / `environment`: مجال وبيئة الحدث
- `time`: نقطة أو فترة زمنية
- `intensity`: شدة الحدث (اختياري)
- `probability`: احتمال وقوع الحدث (اختياري)

هذا يتوافق مع حقائق من نحو `event/4`, وبُنى `حدث_معرفي` في النموذج المعرفي–الدلالي.

### 4.4 التحوّلات (transforms)

التحوّلات تجميع للتغيّرات في الحالات/الخصائص الناتجة عن الأحداث.

لكل تحوّل عام:

- `event_id`: معرف الحدث المسبِّب (إن وجد)
- `entity_id`: الكيان المتحوّل
- `state_name`: اسم الحالة/الخاصية
- `before`: القيمة قبل الحدث
- `after`: القيمة بعد الحدث
- `law`: القانون/المعادلة المُطبّقة (إن وُجد)

ويمكن ربطه مباشرة بـ `changed/4` وحقائق المعادلات في نظام الكيانات.

### 4.5 الأفكار (ideas) — اختياري

على طبقة أعلى، يمكن تمثيل "فكرة" كمركّب من:

- مجموعة كيانات ذات أدوار مفاهيمية معينة
- واحد أو أكثر من الأحداث
- نمط تحوّل معيّن

هذا القسم يربط مباشرة مع مفهوم `فكرة` و`كيان_معرفي` في `COGNITIVE_SEMANTIC_GUIDE.md`.

### 4.6 البيانات الوصفية (meta)

يحتوي على معلومات مثل:

- `source`: مصدر المعرفة (استنتاج، ملاحظة، قاعدة، ...)
- `confidence`: درجة الثقة في الأثر ككل
- `time_frame`: إطار زمني عام للمشهد
- `narrative_perspective`: منظور السرد (اختياري لاحقًا)

---

## 5. العلاقة مع محرك الكيانات والنموذج الوجودي

- يمكن بناء الأثر التصوّري تلقائيًا من:
  - سجلات الأحداث في محرك الكيانات (events log)،
  - حقائق `entity/1`, `state/3`, `property/3`, `event/4`, `changed/4`,
  - تعريفات المجال والبيئة والكائن الوجودي في النموذج الوجودي.
- يمكن أيضًا بناؤه يدويًا/تصميميًا في مجالات خاصة، مع الحفاظ على نفس البنية العامة (entities, events, transforms...).

بهذا يصبح الأثر التصوّري **نقطة الالتقاء**:

- نحو الأسفل: مع المنطق، الشبكات الدلالية، الكيانات، المعادلات.
- نحو الأعلى: مع الجسر اللغوي، القوالب التعبيرية، والنموذج اللغوي التوليدي.

هذا المستند لا يفرض تمثيلًا واحدًا داخل بيان، بل يحدّد المكوّنات المنطقية التي ينبغي لأي تمثيل أن يغطيها كي يكون قابلًا للتكامل مع بقية المنظومة.
