# المنطق في لغة البيان (٣): المنطق المتقدّم وقاعدة المعرفة الديناميكية

<div dir="rtl">

> في هذا الجزء ننتقل إلى مستوى أعمق:
> - **جمع كل الحلول** لسؤال منطقي في قائمة.
> - **حساب عدد الحلول** بطريقة منطقية.
> - **تعديل قاعدة المعرفة أثناء التنفيذ** (إضافة/حذف حقائق).
>
> سنستمر في استخدام:
> - الكتلة `هجين { ... }` (الشكل العربي المفضل في الأمثلة).
> - الكلمة العربية `استعلام` في الاستعلامات.
> - أسماء علاقات ومتغيرات وبيانات عربية بالكامل.
>
> ملاحظة تقنية: توجد بعض الأدوات المدمجة في المترجم بأسمائها الإنجليزية الأصلية مثل `findall`, `bagof`, `setof`, `assertz`, `retract`. لا توجد لها حالياً مرادفات عربية في المترجم، لذلك سنستعملها **داخل قواعد عربية** كأسماء تقنية ثابتة، ونبني حولها واجهات عربية واضحة.

## ١١. جمع الحلول في قائمة (مفهوم "كل من يحقق الشرط")

أحياناً لا نريد حلاً واحداً فقط، بل **كل الحلول** في مكان واحد (قائمة). مثلاً: كل من يحب الشاي.

```bayan
هجين {
    يحب_مشروب("أحمد", "شاي").
    يحب_مشروب("أحمد", "قهوة").
    يحب_مشروب("فاطمة", "شاي").
    يحب_مشروب("ليان", "عصير").

    كل_محبي_الشاي(?قائمة_أشخاص) :-
        findall(?شخص,
                يحب_مشروب(?شخص, "شاي"),
                ?قائمة_أشخاص).
}
استعلام كل_محبي_الشاي(?أسماء)?
```

- القاعدة `كل_محبي_الشاي/1` **واجهة عربية** حول الأداة التقنية `findall`.
- `findall` تأخذ:
  - المتغير الذي نريد جمع قيمه (`?شخص`).
  - شرط التحقيق (`يحب_مشروب(?شخص, "شاي")`).
  - متغير قائمة النتيجة (`?قائمة_أشخاص`).
- الاستعلام يعيد مثلاً: `?أسماء = ["أحمد", "فاطمة"]`.

## ١٢. حساب عدد الحلول (كم عدد من يحقق الشرط؟)

يمكننا استخدام نفس الفكرة مع دالة طول_قائمة/2 التي عرفناها في الجزء السابق.

```bayan
هجين {
    يحب_شاي("أحمد"). يحب_شاي("فاطمة"). يحب_شاي("سارة").

    كل_من_يحب_الشاي(?قائمة) :-
        findall(?شخص, يحب_شاي(?شخص), ?قائمة).

    عدد_محبي_الشاي(?عدد) :-
        كل_من_يحب_الشاي(?قائمة),
        طول_قائمة(?قائمة, ?عدد).
}
استعلام عدد_محبي_الشاي(?ناتج)?
```

- أولاً نجمع كل من يحقق الشرط في قائمة.
- ثم نستعمل قاعدة `طول_قائمة/2` لحساب عدد العناصر.
- النتيجة: `?ناتج = 3` في المثال السابق.

## ١٣. قاعدة معرفة ديناميكية (إضافة/حذف حقائق)

من الميزات القوية في البيان إمكانية **تغيير قاعدة المعرفة أثناء التشغيل**:
- إضافة حقيقة جديدة.
- حذف حقيقة موجودة.

### ١٣.١ مثال: من في المكتبة الآن؟

نفترض أننا نريد تمثيل الأشخاص الموجودين حالياً في مكتبة.

```bayan
هجين {
    موجود_في_المكتبة("أحمد").
    موجود_في_المكتبة("فاطمة").

    أضف_شخص_إلى_المكتبة(?شخص) :-
        assertz(موجود_في_المكتبة(?شخص)).

    احذف_شخص_من_المكتبة(?شخص) :-
        retract(موجود_في_المكتبة(?شخص)).
}
```

- `أضف_شخص_إلى_المكتبة/1` واجهة عربية تقوم بنداء `assertz` لإضافة حقيقة في نهاية قاعدة المعرفة.
- `احذف_شخص_من_المكتبة/1` واجهة عربية حول `retract` لحذف حقيقة واحدة تطابق النمط.

استخدامها عملياً (بتسلسل تفاعلي):

1. الاستعلام عن الموجودين حالياً:
   ```bayan
   استعلام موجود_في_المكتبة(?من)?
   ```
2. إضافة شخص جديد:
   ```bayan
   أضف_شخص_إلى_المكتبة("سارة").
   ```
3. الاستعلام مرة أخرى:
   ```bayan
   استعلام موجود_في_المكتبة(?من)?
   ```
4. حذف شخص:
   ```bayan
   احذف_شخص_من_المكتبة("أحمد").
   ```

بهذا الشكل يمكن بناء **نظام حالة** بسيط يعتمد على حقائق منطقية تُحدَّث أثناء التشغيل.

## ١٤. ملخص هذا الجزء

- تعلمنا كيف نجمع كل الحلول لسؤال منطقي في **قائمة** باستخدام واجهات عربية فوق الأداة `findall`.
- استخدمنا ذلك لحساب **عدد الحلول** باستخدام `طول_قائمة/2`.
- عرفنا كيف نجعل قاعدة المعرفة **ديناميكية** عبر واجهات عربية (`أضف_شخص_إلى_المكتبة`, `احذف_شخص_من_المكتبة`) مبنية على الأدوات `assertz` و`retract`.

في الأجزاء التالية سننتقل إلى ميزات أكثر تميزاً وابتكاراً في البيان:
- الاستدلال الاحتمالي والتشكيك.
- الشبكات السببية.
- الكيانات والمعادلات والمشغلات اللغوية.
- نموذج الفكرة–الحدث–النتيجة.
- المترادفات/التشابه، والشبكات الدلالية، وطبقات Conceptual LM قبل النموذج اللغوي.

</div>

