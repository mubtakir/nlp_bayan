# المنطق في لغة البيان (٢): القواعد المركّبة والعودية والقوائم والمنطق

<div dir="rtl">

> هذا الجزء يبني فوق الأساسيات في **الجزء (١)**، ويشرح كيف نكتب قواعد أقوى:
> - قواعد مركّبة تحتوي أكثر من شرط.
> - قواعد عودية (تعريف شيء عن طريق نفسه).
> - القوائم في المنطق.
> - العمليات المنطقية (و / أو) بين القواعد.
>
> سنستمر في استخدام:
> - سنستخدم الكتلة العربية `هجين { ... }` في الأمثلة، مع الإشارة مرة واحدة فقط إلى أن `hybrid { ... }` هي الاسم الإنجليزي المكافئ في الشيفرات الأقدم.
> - الكلمة العربية `استعلام` بدل `query`.
> - علاقات وأسماء ومتغيرات عربية بالكامل قدر الإمكان.

## ٦. القواعد المركّبة (أكثر من شرط)

أحيانًا نريد تعريف مفهوم يعتمد على **عدة حقائق معًا**. مثلًا: "محب_شاي_وقهوة" هو من يحب الشاي ويحب القهوة.

```bayan
هجين {
    يحب_مشروب("أحمد", "شاي").
    يحب_مشروب("أحمد", "قهوة").
    يحب_مشروب("فاطمة", "قهوة").

    محب_شاي_وقهوة(?شخص) :-
        يحب_مشروب(?شخص, "شاي"),
        يحب_مشروب(?شخص, "قهوة").
}
```

- القاعدة تقول: **الشخص محب_شاي_وقهوة إذا تحقق الشرطان معًا**.
- الفاصلة `,` تعني **و (AND)** بين الشروط.

استعلام:

```bayan
استعلام محب_شاي_وقهوة(?من)?
```

- النتيجة ستكون: `?من = "أحمد"` فقط.

## ٧. العودية (تعريف شيء عن طريق نفسه)

العودية تسمح لنا بتعريف مفاهيم مثل: "مسار" بين نقطتين في شبكة طرق.

### ٧.١ مثال: مسار بين مدن

```bayan
هجين {
    طريق("الرياض", "القصيم").
    طريق("القصيم", "حائل").
    طريق("حائل", "الجوف").

    مسار(?من, ?إلى) :-
        طريق(?من, ?إلى).

    مسار(?من, ?إلى) :-
        طريق(?من, ?متوسط),
        مسار(?متوسط, ?إلى).
}
```

- القاعدة الأولى: يوجد مسار مباشر إذا كان هناك "طريق" مباشر.
- القاعدة الثانية (العودية): يوجد مسار إذا كان هناك طريق إلى نقطة **متوسطة**، ومن هذه النقطة يوجد مسار إلى الهدف.

استعلام:

```bayan
استعلام مسار("الرياض", ?مدينة_نهائية)?
```

يعيد مثلًا:

- `?مدينة_نهائية = "القصيم"`
- `?مدينة_نهائية = "حائل"`
- `?مدينة_نهائية = "الجوف"`

### ٧.٢ مثال: السلف (الأجداد)

```bayan
هجين {
    أب("أحمد", "محمد").
    أب("محمد", "ليان").
    أب("ليان", "سارة").

    سلف(?سابق, ?لاحق) :-
        أب(?سابق, ?لاحق).

    سلف(?سابق, ?لاحق) :-
        أب(?سابق, ?متوسط),
        سلف(?متوسط, ?لاحق).
}
```

- الآن `سلف("أحمد", "ليان")` و`سلف("أحمد", "سارة")` كلاهما صحيح.

## ٨. القوائم في المنطق

لغة البيان تدعم القوائم داخل المنطق بشكل شبيه بقوائم Prolog.

- قائمة فارغة: `[]`.
- قائمة بعناصر: `[1, 2, 3]` أو `["أحمد", "فاطمة"]`.
- نمط رأس/ذيل: `[ ?رأس | ?ذيل ]`.

### ٨.١ مثال: عضو في قائمة

```bayan
هجين {
    عضو_في_قائمة(?عنصر, [ ?عنصر | ?_ ]).

    عضو_في_قائمة(?عنصر, [ ?_ | ?باقي ]) :-
        عضو_في_قائمة(?عنصر, ?باقي).
}
```

استعلام:

```bayan
استعلام عضو_في_قائمة("فاطمة", ["أحمد", "سارة", "فاطمة"])?
```

- يجيب المحرك بأن الاستعلام **صحيح** لأن "فاطمة" موجودة في القائمة.

### ٨.٢ مثال: طول قائمة (بشكل مبسّط)

```bayan
هجين {
    طول_قائمة([], 0).

    طول_قائمة([ ?_ | ?باقي ], ?طول) :-
        طول_قائمة(?باقي, ?طول_باقي),
        ?طول is ?طول_باقي + 1.
}
```

- نستخدم هنا خليطًا بين المنطق والحساب العددي (`is` + `+`).

استعلام:

```bayan
استعلام طول_قائمة([1, 2, 3, 4], ?ناتج)?
```

- يعيد: `?ناتج = 4`.

## ٩. العمليات المنطقية (و / أو) بين القواعد

نستطيع التعبير عن **أو (OR)** باستخدام تعريفات متعددة لنفس القاعدة.

### ٩.١ مثال: يحب_حلوى (شخص يحب نوعًا من الحلوى)

```bayan
هجين {
    يحب("أحمد", "آيس_كريم").
    يحب("أحمد", "قهو_مرة").
    يحب("فاطمة", "كعك").

    يحب_حلوى(?شخص) :- يحب(?شخص, "آيس_كريم").
    يحب_حلوى(?شخص) :- يحب(?شخص, "كعك").
}
```

- هنا استخدمنا **قانونين** مختلفين لـ`يحب_حلوى/1`:
  - إما أن يحب الآيس كريم.
  - أو يحب الكعك.

استعلام:

```bayan
استعلام يحب_حلوى(?من)?
```

- النتيجة تقريبًا: `?من = "أحمد"` و`?من = "فاطمة"`.

## ١٠. تنظيم قاعدة المعرفة

في المشاريع الحقيقية نحتاج إلى تنظيم المعرفة:

- فصل الحقائق العامة (مثل "حقائق عن المدن") عن الحقائق الخاصة بالتطبيق.
- فصل القواعد الخاصة بكل مجال.
- كتابة أسماء واضحة للعلاقات والمتغيرات حتى تصبح الاستعلامات مفهومة.

مثال مبسّط على فصل قسمين في نفس الملف:

```bayan
هجين {
    # قسم: حقائق عن المدن
    مدينة("الرياض"). مدينة("القصيم"). مدينة("حائل").

    # قسم: علاقات طرق
    طريق("الرياض", "القصيم").
    طريق("القصيم", "حائل").

    # قسم: قواعد المسارات
    مسار(?من, ?إلى) :- طريق(?من, ?إلى).
    مسار(?من, ?إلى) :- طريق(?من, ?متوسط), مسار(?متوسط, ?إلى).
}
```

في الجزء التالي سننتقل إلى **المستوى المتقدّم**:

- القواعد المتقدّمة لجمع الحلول (`findall` وأقاربها) ولكن مع أمثلة عربية.
- قاعدة المعرفة الديناميكية (إضافة/حذف حقائق أثناء التنفيذ).
- دمج المنطق مع الأجزاء الإجرائية/الكائنية في مشاريع أكبر.

وهذه اللبنات ستكون مدخلك لاحقًا إلى الأجزاء ٤–١٠ حيث نتعامل مع الاحتمالات والشبكات السببية والكيانات والشبكات الدلالية وطبقات ما قبل النموذج اللغوي (Conceptual LM).

</div>

