# المنطق في لغة البيان (٩): المترادفات والتقارب والتشابه

<div dir="rtl">

> في الأجزاء السابقة رأينا الحقائق والقواعد والاحتمالات والكيانات والشبكات السببية والدلالية.
> في هذا الجزء نضيف طبقة جديدة مهمّة:
>
> **المترادفات والتقارب (Similarity)** كميزة أساسية في البيان،
> بحيث يمكن أن نقول: `أسد` قريب من `غضنفر` بدرجة 0.8 مثلًا،
> ونستخدم ذلك في المنطق، وفي التوليد، وفي كل ما قبل النموذج اللغوي.

---

## ١. الفكرة: «مجموعة متقاربة» بدل كلمة واحدة فقط

نريد أن نمثّل **مفهومًا** (كلمة أو كيان أو تفاعل...) ومعه عناصر قريبة منه بدرجات [0..1].

### ١٫١ مثال لغوي بسيط (DSL أعلى مستوى)

الصياغة المبدئية المقترحة في الـ RFC:

```bayan
أسد(غضنفر:0.8، هيضم:0.5)  # القيمة الافتراضية عند الإغفال: 0.7
```

يمكنك أن تقرأها هكذا:

- "أسد" هو **رأس المفهوم**.
- "غضنفر" قريب منه بدرجة 0.8 (مرادف قوي).
- "هيضم" قريب بدرجة 0.5 (أضعف قليلًا).

الفكرة أعمّ من اللغة الطبيعية؛ يمكن استعمال نفس الشكل في مجالات أخرى:

```bayan
ناتج_كيميائي(تفاعلA:0.9، تفاعلB:0.6)
صوت(طنين:0.8، أزيز:0.5)
```

---

## ٢. وحدة التشابه العامة: `bayan.core.similarity`

توفّر هذه الوحدة طبقة منطقية عامة (غير محصورة في NLP)، فيها حقائق وقواعد مثل:

- `similar(X, Y, Score, Kind, Domain)`
- `sim_threshold(Kind, Tau)`
- `close(X, Y, Tau, Kind)` و`close(X, Y, Kind)`
- `synonym(X, Y, S)` كسكّر للمترادفات اللغوية.

### ٢٫١ أمثلة افتراضية داخل الوحدة

بعض الأمثلة المضمّنة (يمكنك اعتبارها قاعدة معرفة صغيرة):

```bayan
هجين {
    similar("أسد", "غضنفر", 0.8, "syn", "lexicon").
    similar("أسد", "هيضم",   0.5, "syn", "lexicon").

    sim_threshold("syn",   0.7).
    sim_threshold("alias", 0.7).
}
```

- `"syn"` نوع تقارب للمترادفات اللغوية.
- `"alias"` لتقارب «أسماء مختلفة لنفس الشيء».

---

## ٣. واجهة عربية للاستعلام عن المترادفات والتقارب

لنعرّف واجهة عربية حول هذه الحقائق والقواعد:

```bayan
هجين {
    import bayan.core.similarity as sim
    sim.load_selective(logical, ["similarity"])

    مرادف(?أصل, ?كلمة, ?درجة) :- synonym(?أصل, ?كلمة, ?درجة).
    قريب(?أصل, ?كلمة)        :- close(?أصل, ?كلمة, "syn").
    قريب_بدرجة(?أصل, ?كلمة, ?عتبة) :- close(?أصل, ?كلمة, ?عتبة, "syn").
}

استعلام مرادف("أسد", ?كلمة, ?درجة)?
استعلام قريب("أسد", "غضنفر")?
استعلام قريب_بدرجة("أسد", "هيضم", 0.4)?
```

- `مرادف/3` يعيد جميع الكلمات المترادفة مع درجاتها.
- `قريب/2` يستخدم العتبة الافتراضية لنوع `"syn"` (مثلًا 0.7).
- `قريب_بدرجة/3` يسمح لك بتعيين عتبة خاصة (`?عتبة`).

يمكنك الآن استخدام هذه العلاقات داخل قواعد أخرى، تمامًا كما تستخدم أي علاقة منطقية.

---

## ٤. أنواع التقارب والمجالات (Kinds & Domains)

من الـ RFC الخاص بالمترادفات:

- `Domain` (المجال):
  - `"lexicon"` (معجم كلمات).
  - `"chem"` (كيمياء)، `"physics"`, `"behavior"`, ...
- `Kind` (نوع التقارب):
  - `"syn"` (مترادفات لغوية).
  - `"alias"` (أسماء مختلفة لنفس الشيء).
  - `"approx_eq"` (تقارب عددي/وحدات).
  - `"pattern"` (تشابه نمطي)، وغير ذلك.

الفكرة:

> **نفس البنية** `similar/5` و `close/3` يمكن استخدامها في
> المعجم اللغوي، والكيمياء، ووحدات القياس، والطب، والسلوك...

### ٤٫١ مثال صغير على alias (اسم بديل)

```bayan
هجين {
    import bayan.core.similarity as sim
    sim.load_selective(logical, ["similarity"])

    # افترض أن قاعدة المعرفة تحتوي على:
    # similar("سيارة", "عربة", 0.9, "alias", "lexicon").

    اسم_بديل(?أصل, ?اسم) :- close(?أصل, ?اسم, "alias").
}

استعلام اسم_بديل("سيارة", ?اسم_آخر)?
```

---

## ٥. الربط مع البرمجة الدلالية والنموذج اللغوي

هذه الطبقة تعمل **قبل النموذج اللغوي** وتخدمه:

- في البرمجة الدلالية:
  - يمكن استغلال `similar/5` لتوسيع البحث في شبكات المعاني `معنى`.
  - أو لاكتشاف معلومات قريبة في `معلومة` و`معرفة_متطورة`.
- في توليد النصوص (مع `ai/nlp` و`nlp_bayan`):
  - يمكن استعمال التشابه لاقتراح مرشحين لغويين بديلين (كلمات قريبة).
  - أو لرفع/خفض احتمال كلمة في نموذج اللغة حسب قربها من معنى معيّن.

بهذا يصبح **المترادف/المتقارب** كيانًا من الدرجة الأولى في البيان،
ليس فقط كقائمة كلمات في NLP، بل كجزء من البنية المنطقية والمعرفية
التي يمكن الاستعلام منها والاعتماد عليها في كل الطبقات الأعلى.

## ٦. مثال عملي: توسيع استعلام عربي بالمترادفات

```bayan
هجين {
    # نفترض أن مرادف/3 متاحة كما في المثال السابق
    يحب("أحمد", "أسد").
    يحب("سارة", "غضنفر").

    يحب_حيوان_موسع(?شخص, ?اسم_قريب) :-
        يحب(?شخص, ?اسم_أصلي),
        مرادف(?اسم_أصلي, ?اسم_قريب, ?درجة),
        ?درجة >= 0.6.
}

استعلام يحب_حيوان_موسع(?شخص, ?اسم)?
```

- `يحب/2` يعرّف الحقائق الأصلية بأسماء معيّنة (مثل `"أسد"`).
- `يحب_حيوان_موسع/2` يستخدم `مرادف/3` لإرجاع **كل الأسماء القريبة** بدرجة كافية،
  بحيث يمكن أن يظهر `"غضنفر"` أو `"هيضم"` حتى لو لم تكتبها في الحقائق مباشرة.

</div>

