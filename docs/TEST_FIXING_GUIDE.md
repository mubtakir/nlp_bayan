# ุฏููู ุฅุตูุงุญ ุงูุงุฎุชุจุงุฑุงุช ุงููุงุดูุฉ
# Test Fixing Guide for Next AI Model

**ุงูุชุงุฑูุฎ:** 2025-11-17  
**ุงูุญุงูุฉ:** 144 ุงุฎุชุจุงุฑ ูุงุดู ูู ุฃุตู 605 (76.2% ูุฌุงุญ)  
**ุงููุฏู:** 95%+ ูุฌุงุญ (ุฃูู ูู 30 ุงุฎุชุจุงุฑ ูุงุดู)

---

## ๐ ููุฎุต ุงูุงุฎุชุจุงุฑุงุช ุงููุงุดูุฉ

### ุญุณุจ ุงูููู

| ุงูููู | ุนุฏุฏ ุงููุงุดู | ุงูุฃููููุฉ |
|------|------------|----------|
| `test_nlp_bayan_generation.py` | 8 | โญโญโญ ุนุงููุฉ ุฌุฏุงู |
| `test_operators.py` | 1 | โญโญโญ ุนุงููุฉ |
| `test_prob_thresholds_topk.py` | 1 | โญโญ ูุชูุณุทุฉ |
| `test_similarity_core.py` | 4 | โญโญ ูุชูุณุทุฉ |
| `test_template_match.py` | 3 | โญโญ ูุชูุณุทุฉ |
| `test_temporal_constructs.py` | 2 | โญ ููุฎูุถุฉ |
| **ุงููุฌููุน** | **19+** | |

**ููุงุญุธุฉ:** ูุฏ ูููู ููุงู ุงุฎุชุจุงุฑุงุช ูุงุดูุฉ ุฃุฎุฑู ูู ุชุธูุฑ ูู ุงูููุฎุต.

---

## ๐ ุชุญููู ุชูุตููู ููู ููู

### 1. test_nlp_bayan_generation.py (8 ุงุฎุชุจุงุฑุงุช) โญโญโญ

#### ุงูุงุฎุชุจุงุฑุงุช ุงููุงุดูุฉ:
```
1. test_morpho_inserts_min_for_ghadara
2. test_istaqara_prefers_indoor_over_outdoor
3. test_haraba_prefers_outdoor_and_inserts_min
4. test_tawajjaha_inserts_ila_prefers_high_prob_go_target
5. test_empty_docs_safe_generation_go_seeded
6. test_combined_controls_no_crash_and_respect_length
7. test_raja_morphology_inserts_ila_and_picks_house_by_docs
8. test_raja_prefers_house_over_others
```

#### ุงููุดููุฉ ุงููุญุชููุฉ:
- **ุชูููุฏ ุงููุตูุต ุงูุนุฑุจูุฉ** ูุน morphology
- **ุญุฑูู ุงูุฌุฑ** (ููุ ุฅููุ ูู)
- **ุงุฎุชูุงุฑ ุงููููุงุช** ุจูุงุกู ุนูู ุงูุณูุงู ูุงูุงุญุชูุงูุงุช
- **Preference system** ูุง ูุนูู ุจุดูู ุตุญูุญ

#### ุงููููุงุช ุงููุนููุฉ:
```
nlp_bayan/generation.bayan
nlp_bayan/morphology.bayan
nlp_bayan/preference.bayan
nlp_bayan/probability.bayan
```

#### ุฎุทูุงุช ุงูุฅุตูุงุญ:

**ุงูุฎุทูุฉ 1:** ุดุบูู ุงุฎุชุจุงุฑ ูุงุญุฏ ูููู ุงูุฎุทุฃ
```bash
python -m pytest tests/test_nlp_bayan_generation.py::test_morpho_inserts_min_for_ghadara -v -s
```

**ุงูุฎุทูุฉ 2:** ุงูุญุต ุฑุณุงูุฉ ุงูุฎุทุฃ
- ูู ูู `SyntaxError`? โ ูุดููุฉ ูู ุงูููุฏ
- ูู ูู `AssertionError`? โ ุงูููุทู ุฎุงุทุฆ
- ูู ูู `ImportError`? โ ููู ููููุฏ

**ุงูุฎุทูุฉ 3:** ุงูุญุต ุงูููู ุงููุนูู
```bash
# ุงุณุชุฎุฏู view ููุฑุงุกุฉ ุงูููู
view nlp_bayan/generation.bayan
```

**ุงูุฎุทูุฉ 4:** ุงุจุญุซ ุนู ุงูุฏุงูุฉ ุงููุนููุฉ
```bash
# ุงุณุชุฎุฏู codebase-retrieval
codebase-retrieval "morpho_inserts_min function in nlp_bayan"
```

**ุงูุฎุทูุฉ 5:** ุฃุตูุญ ุงูุฎุทุฃ
- ุงุณุชุฎุฏู `str-replace-editor` ููุชุนุฏูู
- ูุง ุชุนุฏู ุฃูุซุฑ ูู ุงููุงุฒู
- ุงุฎุชุจุฑ ูุฑุฉ ุฃุฎุฑู

**ุงูุฎุทูุฉ 6:** ุชุฃูุฏ ูู ุนุฏู ูุณุฑ ุงุฎุชุจุงุฑุงุช ุฃุฎุฑู
```bash
python -m pytest tests/test_nlp_bayan_generation.py -v
```

---

### 2. test_operators.py (1 ุงุฎุชุจุงุฑ) โญโญโญ

#### ุงูุงุฎุชุจุงุฑ ุงููุงุดู:
```
test_operator_go_ar
```

#### ุงููุดููุฉ ุงููุญุชููุฉ:
- `SyntaxError` ูู ุนุงูู ููุทูู ุนุฑุจู
- ุฑุจูุง ุชุนุงุฑุถ ูุน ูููุฉ ูุญุฌูุฒุฉ
- ูุดููุฉ ูู `lexer.py` ุฃู `parser.py`

#### ุฎุทูุงุช ุงูุฅุตูุงุญ:

**ุงูุฎุทูุฉ 1:** ุดุบูู ุงูุงุฎุชุจุงุฑ
```bash
python -m pytest tests/test_operators.py::test_operator_go_ar -v -s
```

**ุงูุฎุทูุฉ 2:** ุงูุฑุฃ ุฑุณุงูุฉ ุงูุฎุทุฃ ุจุนูุงูุฉ
- ูุง ูู ุงููููุฉ ุงูุชู ุชุณุจุจ ุงููุดููุฉุ
- ูู ูู ูููุฉ ูุญุฌูุฒุฉุ

**ุงูุฎุทูุฉ 3:** ุงูุญุต ุงููููุงุช ุงููุญุฌูุฒุฉ
```python
# ูู bayan/lexer.py
ARABIC_KEYWORDS = {
    "ุงุณุชุนูุงู": TokenType.QUERY,  # ูุฐู ูุงูุช ุงููุดููุฉ ุงูุณุงุจูุฉ
    # ... ุงุจุญุซ ุนู ูููุงุช ุฃุฎุฑู
}
```

**ุงูุฎุทูุฉ 4:** ุฃุตูุญ
- ุฅุฐุง ูุงูุช ูููุฉ ูุญุฌูุฒุฉุ ุบููุฑ ุงุณู ุงููุชุบูุฑ/ุงููุนุงูู
- ุฅุฐุง ูุงูุช ูุดููุฉ parserุ ุฃุตูุญ ุงููุงุนุฏุฉ ุงููุญููุฉ

---

### 3. test_prob_thresholds_topk.py (1 ุงุฎุชุจุงุฑ) โญโญ

#### ุงูุงุฎุชุจุงุฑ ุงููุงุดู:
```
test_maybe_likely_and_topk_prob_fallback
```

#### ุงููุดููุฉ ุงููุญุชููุฉ:
- ููุทู ุงูุงุญุชูุงูุงุช ูุงูุนุชุจุงุช
- ุฏูุงู `maybe()` ู `likely()` ูุง ุชุนูู
- `topk` ูุน `fallback` ูุง ูุนูู

#### ุงููููุงุช ุงููุนููุฉ:
```
nlp_bayan/probability.bayan
nlp_bayan/thresholds.bayan
```

#### ุฎุทูุงุช ุงูุฅุตูุงุญ:
1. ุดุบูู ุงูุงุฎุชุจุงุฑ ูุงูุญุต ุงูุฎุทุฃ
2. ุงูุญุต ุฏูุงู `maybe()` ู `likely()`
3. ุงูุญุต ููุทู `topk_prob_fallback()`
4. ุฃุตูุญ ุงูููุทู
5. ุงุฎุชุจุฑ ูุฑุฉ ุฃุฎุฑู

---

### 4. test_similarity_core.py (4 ุงุฎุชุจุงุฑุงุช) โญโญ

#### ุงูุงุฎุชุจุงุฑุงุช ุงููุงุดูุฉ:
```
1. test_close_with_default_threshold
2. test_close_with_explicit_tau
3. test_synonym_rule_lists_pairs
4. test_synset_function_adds_pairs
```

#### ุงููุดููุฉ ุงููุญุชููุฉ:
- `SyntaxError` ูู ูุธุงู ุงูุชุดุงุจู
- ุฏูุงู `close()`, `synonym()`, `synset()` ูุง ุชุนูู
- ูุดููุฉ ูู `similarity_core.bayan`

#### ุงููููุงุช ุงููุนููุฉ:
```
nlp_bayan/similarity_core.bayan
nlp_bayan/synonyms.bayan
```

#### ุฎุทูุงุช ุงูุฅุตูุงุญ:
1. ุดุบูู ูู ุงุฎุชุจุงุฑ ุนูู ุญุฏุฉ
2. ุงูุญุต `similarity_core.bayan` ููุฃุฎุทุงุก
3. ุงุจุญุซ ุนู `SyntaxError`
4. ุฃุตูุญ ุงูุฃุฎุทุงุก
5. ุงุฎุชุจุฑ ูุฑุฉ ุฃุฎุฑู

---

### 5. test_template_match.py (3 ุงุฎุชุจุงุฑุงุช) โญโญ

#### ุงูุงุฎุชุจุงุฑุงุช ุงููุงุดูุฉ:
```
1. test_template_match_simple_ar
2. test_template_match_with_regex_and_render
3. test_match_str_direct_without_compile
```

#### ุงููุดููุฉ ุงููุญุชููุฉ:
- ูุธุงู template matching ูุง ูุนูู
- regex ูุง ูุนูู
- render ูุง ูุนูู

#### ุงููููุงุช ุงููุนููุฉ:
```
nlp_bayan/template_match.bayan
nlp_bayan/regex.bayan
```

#### ุฎุทูุงุช ุงูุฅุตูุงุญ:
1. ุดุบูู ุงูุงุฎุชุจุงุฑุงุช
2. ุงูุญุต `template_match.bayan`
3. ุงูุญุต ุฏูุงู regex
4. ุฃุตูุญ ุงูุฃุฎุทุงุก
5. ุงุฎุชุจุฑ ูุฑุฉ ุฃุฎุฑู

---

### 6. test_temporal_constructs.py (2 ุงุฎุชุจุงุฑ) โญ

#### ุงูุงุฎุชุจุงุฑุงุช ุงููุงุดูุฉ:
```
1. test_delay_statement_english
2. test_delay_statement_arabic
```

#### ุงููุดููุฉ ุงููุญุชููุฉ:
- `SyntaxError` ูู `delay` statement
- ูุดููุฉ ูู parser

#### ุงููููุงุช ุงููุนููุฉ:
```
bayan/parser.py
nlp_bayan/temporal_constructs.bayan
```

#### ุฎุทูุงุช ุงูุฅุตูุงุญ:
1. ุดุบูู ุงูุงุฎุชุจุงุฑุงุช
2. ุงูุญุต ุฑุณุงูุฉ ุงูุฎุทุฃ
3. ุงูุญุต `parser.py` ูู `delay` statement
4. ุฃุตูุญ ุงููุงุนุฏุฉ ุงููุญููุฉ
5. ุงุฎุชุจุฑ ูุฑุฉ ุฃุฎุฑู

---

## ๐๏ธ ุฃุฏูุงุช ูููุฏุฉ ููุฅุตูุงุญ

### 1. ุชุดุบูู ุงุฎุชุจุงุฑ ูุงุญุฏ
```bash
python -m pytest tests/FILE.py::TEST_NAME -v -s
```

### 2. ุชุดุบูู ููู ูุงูู
```bash
python -m pytest tests/FILE.py -v
```

### 3. ุชุดุบูู ูู ุงูุงุฎุชุจุงุฑุงุช
```bash
python -m pytest tests/ -v
```

### 4. ุฅุธูุงุฑ ุงูุชูุงุตูู
```bash
python -m pytest tests/FILE.py -v -s --tb=short
```

### 5. ุฅููุงู ุนูุฏ ุฃูู ูุดู
```bash
python -m pytest tests/ -x
```

---

## ๐ ูุงูุจ ูุชูุซูู ุงูุฅุตูุงุญุงุช

ุนูุฏ ุฅุตูุงุญ ุงุฎุชุจุงุฑุ ูุซูู ูู `TEST_FIXES_REPORT.md`:

```markdown
### ุงูุงุฎุชุจุงุฑ: test_name

**ุงูุชุงุฑูุฎ:** 2025-11-17
**ุงูููู:** tests/test_file.py
**ุงูุญุงูุฉ:** โ ูุตูุญ / โ ูู ููุตูุญ

#### ุงููุดููุฉ:
ูุตู ุงููุดููุฉ ุจุงูุชูุตูู

#### ุงูุณุจุจ:
ูุง ุงูุฐู ูุงู ูุณุจุจ ุงููุดู

#### ุงูุญู:
ูุง ุงูุฐู ุชู ุชุบููุฑู

#### ุงููููุงุช ุงููุนุฏูุฉ:
- file1.bayan (ุงูุณุทุฑ X)
- file2.py (ุงูุณุทุฑ Y)

#### ุงูุงุฎุชุจุงุฑ ุจุนุฏ ุงูุฅุตูุงุญ:
```bash
python -m pytest tests/test_file.py::test_name -v
# ุงููุชูุฌุฉ: PASSED โ
```
```

---

## ๐ฏ ุงุณุชุฑุงุชูุฌูุฉ ุงูุฅุตูุงุญ

### ุงููุฑุญูุฉ 1: ุงูููู (ููู 1)
1. ุดุบูู ูู ุงูุงุฎุชุจุงุฑุงุช ูุงุญูุธ ุงููุชุงุฆุฌ
2. ุตููู ุงูุฃุฎุทุงุก (SyntaxError, AssertionError, etc.)
3. ุญุฏุฏ ุงูุฃููููุงุช
4. ุฃูุดุฆ ุฎุทุฉ ุนูู

### ุงููุฑุญูุฉ 2: ุงูุฅุตูุงุญ (ููู 2-6)
1. ุงุจุฏุฃ ุจุงูุฃููููุฉ ุงูุนุงููุฉ
2. ุฃุตูุญ ุงุฎุชุจุงุฑ ูุงุญุฏ ูู ูู ูุฑุฉ
3. ูุซูู ูู ุฅุตูุงุญ
4. ุงุฎุชุจุฑ ุจุนุฏ ูู ุฅุตูุงุญ

### ุงููุฑุญูุฉ 3: ุงูุชุญูู (ููู 7)
1. ุดุบูู ูู ุงูุงุฎุชุจุงุฑุงุช
2. ุชุฃูุฏ ูู ุงููุณุจุฉ 95%+
3. ุฑุงุฌุน ุงูุชูุซูู
4. ุฃูุดุฆ ุชูุฑูุฑ ููุงุฆู

---

## โ๏ธ ุชุญุฐูุฑุงุช ูููุฉ

### 1. ูุง ุชูุณุฑ ูุง ูุนูู
- ูุจู ุงูุชุนุฏููุ ุดุบูู ุงูุงุฎุชุจุงุฑุงุช ุงููุงุฌุญุฉ
- ุจุนุฏ ุงูุชุนุฏููุ ุชุฃูุฏ ุฃููุง ูุง ุฒุงูุช ุชุนูู

### 2. ูุง ุชุนุฏู ุฃูุซุฑ ูู ุงููุงุฒู
- ุฃุตูุญ ุงููุดููุฉ ููุท
- ูุง ุชุนูุฏ ูุชุงุจุฉ ุงูููุฏ ููู

### 3. ุงุฎุชุจุฑ ุชุฏุฑูุฌูุงู
- ูุง ุชุฌูุน ุฅุตูุงุญุงุช ูุซูุฑุฉ ูุจู ุงูุงุฎุชุจุงุฑ
- ุงุฎุชุจุฑ ุจุนุฏ ูู ุชุนุฏูู

### 4. ูุซูู ูู ุดูุก
- ุงูุชุจ ููุงุญุธุฉ ุนู ูู ูุดููุฉ
- ุงูุชุจ ุงูุญู ุจุงูุชูุตูู
- ูุฐุง ุณูุณุงุนุฏ ูู ุงููุณุชูุจู

---

## ๐ ูุชุงุจุนุฉ ุงูุชูุฏู

ุงุณุชุฎุฏู ูุฐุง ุงูุฌุฏูู ููุชุงุจุนุฉ ุชูุฏูู:

| ุงูููู | ุงูููู | ุงูุงุฎุชุจุงุฑุงุช ุงููุตูุญุฉ | ุงููุฌููุน |
|------|------|-------------------|---------|
| 1 | test_nlp_bayan_generation.py | 0/8 | 0/19 |
| 2 | test_nlp_bayan_generation.py | ?/8 | ?/19 |
| 3 | test_operators.py | ?/1 | ?/19 |
| 4 | test_prob_thresholds_topk.py | ?/1 | ?/19 |
| 5 | test_similarity_core.py | ?/4 | ?/19 |
| 6 | test_template_match.py | ?/3 | ?/19 |
| 7 | test_temporal_constructs.py | ?/2 | ?/19 |

**ุงููุฏู ุงูููุงุฆู:** 18/19 ุนูู ุงูุฃูู (95%)

---

## ๐ ุงุจุฏุฃ ุงูุขู!

```bash
# ุงูุฎุทูุฉ 1: ุดุบูู ูู ุงูุงุฎุชุจุงุฑุงุช
cd /home/al-mubtakir/Documents/bayan_python_ide10
python -m pytest tests/ -v > test_results_before.txt

# ุงูุฎุทูุฉ 2: ุงุจุฏุฃ ุจุฃูู ุงุฎุชุจุงุฑ ูุงุดู
python -m pytest tests/test_nlp_bayan_generation.py::test_morpho_inserts_min_for_ghadara -v -s

# ุงูุฎุทูุฉ 3: ุงูุญุต ุงูุฎุทุฃ ูุฃุตูุญู

# ุงูุฎุทูุฉ 4: ุงุฎุชุจุฑ ูุฑุฉ ุฃุฎุฑู

# ุงูุฎุทูุฉ 5: ุงูุชูู ููุงุฎุชุจุงุฑ ุงูุชุงูู
```

**ุจุงูุชูููู! ๐ฏ**

