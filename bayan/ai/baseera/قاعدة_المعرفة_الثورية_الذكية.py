#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
๐ง ูุงุนุฏุฉ ุงููุนุฑูุฉ ุงูุซูุฑูุฉ ุงูุฐููุฉ
ุงููุทูุฑ: ุจุงุณู ูุญูู ุนุจุฏุงููู
ุงูููุฌ: ุซูุฑู ุฎุงูุต ุจุฏูู ููุชุจุงุช ุชูููุฏูุฉ
ุงููุฏู: ูุงุนุฏุฉ ูุนุฑูุฉ ุญููููุฉ ููููุฏุฉ ูููุธุงู ุงูุซูุฑู
"""

import json
import math
import os
import sys
from datetime import datetime
from typing import Dict, List, Any, Optional

# ุฅุถุงูุฉ ูุฌูุฏ knowledge ูููุณุงุฑ
sys.path.append(os.path.join(os.path.dirname(__file__), 'knowledge'))



class RevolutionaryKnowledgeBase:
    """ูุงุนุฏุฉ ุงููุนุฑูุฉ ุงูุซูุฑูุฉ ุงูุฐููุฉ"""
    
    def __init__(self):
        self.system_name = "ูุงุนุฏุฉ ุงููุนุฑูุฉ ุงูุซูุฑูุฉ ุงูุฐููุฉ"
        self.version = "v2.0 - ูุนุฑูุฉ ุฐููุฉ"
        self.creator = "ุจุงุณู ูุญูู ุนุจุฏุงููู"
        self.creation_date = datetime.now().isoformat()

        # ูุงุนุฏุฉ ุงููุนุฑูุฉ ุงูุฃุณุงุณูุฉ
        self.knowledge_base = {}

        # ุชููุฆุฉ ุงููุนุฑูุฉ
        self._initialize_revolutionary_knowledge()
        
        print(f"๐ง ุชู ุชููุฆุฉ {self.system_name} - {self.creator}")
        print(f"๐ ูุงุนุฏุฉ ุงููุนุฑูุฉ ุชุญุชูู ุนูู {len(self.knowledge_base)} ููุถูุน")


    
    def _initialize_revolutionary_knowledge(self):
        """ุชููุฆุฉ ูุงุนุฏุฉ ุงููุนุฑูุฉ ุงูุซูุฑูุฉ"""
        
        # ุงููุธุฑูุงุช ุงูุซูุฑูุฉ ุงูุซูุงุซ
        self.knowledge_base["ุงููุธุฑูุงุช_ุงูุซูุฑูุฉ"] = {
            "ูุธุฑูุฉ_ุซูุงุฆูุฉ_ุงูุตูุฑ": {
                "ุงูุชุนุฑูู": "ุงููุฌููุน ุงููุณุฑู ููู ุดูุก ูุณุงูู ุตูุฑ - ูู ููุฉ ููุง ููุฉ ูุถุงุฏุฉ",
                "ุงููุนุงุฏูุฉ": "ฮฃ(+) + ฮฃ(-) = 0",
                "ุงูุชุทุจููุงุช": [
                    "ุชูุงุฒู ุงูุฃูุธูุฉ ุงููุนูุฏุฉ",
                    "ุญู ุงููุดุงูู ุจุฅูุฌุงุฏ ุงูุฃุถุฏุงุฏ",
                    "ุชุญููู ุงูุงุณุชูุฑุงุฑ ุงูุฏููุงูููู",
                    "ุงูุชูุงุฒู ุงููููู ูู ุงููุฑุงุฑุงุช"
                ],
                "ุฃูุซูุฉ_ุนูููุฉ": {
                    "ุงูุฑูุงุถูุงุช": "ูู ุงููุนุงุฏูุฉ 2+2=4ุ ุงูุชูุงุฒู ูู 4-4=0",
                    "ุงูููุฒูุงุก": "ููู ูุนู ุฑุฏ ูุนู ูุณุงูู ูู ูู ุงูููุฏุงุฑ ููุถุงุฏ ูู ูู ุงูุงุชุฌุงู",
                    "ุงูุญูุงุฉ": "ุงูุชูุงุฒู ุจูู ุงูุนูู ูุงูุฑุงุญุฉุ ุงูุฌุฏ ูุงููุนุจ",
                    "ุงูุงูุชุตุงุฏ": "ุชูุงุฒู ุงูุนุฑุถ ูุงูุทูุจ"
                },
                "ุงูููุฉ": 0.85,
                "ุงูุชุนููุฏ": 0.6
            },
            
            "ูุธุฑูุฉ_ุชุนุงูุฏ_ุงูุฃุถุฏุงุฏ": {
                "ุงูุชุนุฑูู": "ุงูุฃุถุฏุงุฏ ุงูุญููููุฉ ูุชุนุงูุฏุฉ ูู ุงููุถุงุก ุงููููู - ุฒุงููุฉ 90 ุฏุฑุฌุฉ",
                "ุงููุนุงุฏูุฉ": "A โฅ B โบ AยทB = 0",
                "ุงูุชุทุจููุงุช": [
                    "ุญู ุงูุชุนุงุฑุถุงุช ูุงูุตุฑุงุนุงุช",
                    "ุฅูุฌุงุฏ ุญููู ูุจุชูุฑุฉ ูููุดุงูู",
                    "ููู ุงูุนูุงูุงุช ุงููุนูุฏุฉ",
                    "ุงูุชูููุฑ ุฎุงุฑุฌ ุงูุตูุฏูู"
                ],
                "ุฃูุซูุฉ_ุนูููุฉ": {
                    "ุงูููุฏุณุฉ": "ุงูุฎุทูุท ุงููุชุนุงูุฏุฉ ุชุดูู ุฒูุงูุง ูุงุฆูุฉ",
                    "ุงูุชูููุฑ": "ุงููุธุฑ ูููุดููุฉ ูู ุฒุงููุฉ ูุฎุชููุฉ ุชูุงูุงู",
                    "ุงูุฅุจุฏุงุน": "ุงูุฌูุน ุจูู ุฃููุงุฑ ูุชุถุงุฏุฉ ูุฅูุชุงุฌ ุดูุก ุฌุฏูุฏ",
                    "ุงูุนูุงูุงุช": "ุงุญุชุฑุงู ุงูุงุฎุชูุงูุงุช ุจุฏูุงู ูู ูุญุงุฑุจุชูุง"
                },
                "ุงูููุฉ": 0.92,
                "ุงูุชุนููุฏ": 0.7
            },
            
            "ูุธุฑูุฉ_ุงููุชุงุฆู": {
                "ุงูุชุนุฑูู": "ูู ุดูุก ูุจูู ูู ูุชุงุฆู ุฃูููุฉ ูุชุฑุงุจุทุฉ ุชุชุทูุฑ ุญูุฒูููุงู",
                "ุงููุนุงุฏูุฉ": "System = ฮฃ(Filaments) + Connections + Evolution",
                "ุงูุชุทุจููุงุช": [
                    "ุจูุงุก ุฃูุธูุฉ ูุนูุฏุฉ ูู ุนูุงุตุฑ ุจุณูุทุฉ",
                    "ููู ุงูุชุฑุงุจุท ูุงูุชุดุงุจู",
                    "ุงูุชุทูุฑ ูุงูููู ุงููุณุชูุฑ",
                    "ุงูุดุจูุงุช ูุงูุนูุงูุงุช"
                ],
                "ุฃูุซูุฉ_ุนูููุฉ": {
                    "ุงูุจููููุฌูุง": "ุงูุญูุถ ุงููููู ูุจูู ูู ูุชุงุฆู ูุชุฑุงุจุทุฉ",
                    "ุงูุชูููููุฌูุง": "ุงูุฅูุชุฑูุช ุดุจูุฉ ูู ุงูุงุชุตุงูุงุช ุงููุชุฑุงุจุทุฉ",
                    "ุงููุฌุชูุน": "ุงูุนูุงูุงุช ุงูุฅูุณุงููุฉ ุชุดูู ูุณูุฌ ุงููุฌุชูุน",
                    "ุงููุนุฑูุฉ": "ุงูุฃููุงุฑ ุชุชุฑุงุจุท ูุชูููู ููู ุดุงูู"
                },
                "ุงูููุฉ": 0.88,
                "ุงูุชุนููุฏ": 0.8
            }
        }
        
        # ุงูุฑูุงุถูุงุช ุงูุซูุฑูุฉ
        self.knowledge_base["ุงูุฑูุงุถูุงุช_ุงูุซูุฑูุฉ"] = {
            "ุงูุนูููุงุช_ุงูุฃุณุงุณูุฉ": {
                "ุงูุฌูุน": {
                    "ุงูุชุนุฑูู": "ุฏูุฌ ุงููููุงุช ูุน ุชุทุจูู ุซูุงุฆูุฉ ุงูุตูุฑ",
                    "ูุซุงู": "2+2=4ุ ูุงูุชูุงุฒู ุงูุซูุฑู: 4+(-4)=0",
                    "ุงูุชุทุจูู_ุงูุซูุฑู": "ูู ุฌูุน ูุฎูู ุชูุงุฒู ูุถุงุฏ"
                },
                "ุงูุทุฑุญ": {
                    "ุงูุชุนุฑูู": "ุฅูุฌุงุฏ ุงููุฑู ูุน ูุฑุงุนุงุฉ ุงูุชุนุงูุฏ",
                    "ูุซุงู": "5-3=2ุ ูุงูุชุนุงูุฏ: 2โฅ(-2)",
                    "ุงูุชุทุจูู_ุงูุซูุฑู": "ุงูุทุฑุญ ููุดู ุงูุนูุงูุงุช ุงููุชุนุงูุฏุฉ"
                },
                "ุงูุถุฑุจ": {
                    "ุงูุชุนุฑูู": "ุชูุฑุงุฑ ูุน ุชุทุจูู ูุธุฑูุฉ ุงููุชุงุฆู",
                    "ูุซุงู": "3ร4=12ุ ูุดุจูุฉ ูู 12 ูุชูู ูุชุฑุงุจุท",
                    "ุงูุชุทุจูู_ุงูุซูุฑู": "ุงูุถุฑุจ ููุดุฆ ุดุจูุงุช ูุชูููุฉ"
                },
                "ุงููุณูุฉ": {
                    "ุงูุชุนุฑูู": "ุชูุฒูุน ูุน ุงูุญูุงุธ ุนูู ุงูุชูุงุฒู",
                    "ูุซุงู": "12รท3=4ุ ูุน ุชูุงุฒู: 4ร3=12",
                    "ุงูุชุทุจูู_ุงูุซูุฑู": "ุงููุณูุฉ ุชุญุงูุธ ุนูู ุงูุชูุงุฒู ุงููููู"
                }
            }
        }
        
        # ุงูููุณูุฉ ุงูุซูุฑูุฉ
        self.knowledge_base["ุงูููุณูุฉ_ุงูุซูุฑูุฉ"] = {
            "ุงููุฌูุฏ": {
                "ุงูุชุนุฑูู": "ุงููุฌูุฏ ูู ุงูุชูุงุฒู ุงูุฏููุงูููู ุจูู ุงููููููุฉ ูุงููุงูููููุฉ",
                "ุงูููุธูุฑ_ุงูุซูุฑู": "ูู ููุฌูุฏ ูู ูุงููุฌูุฏ ูุชุนุงูุฏ ูุญูู ุงูุชูุงุฒู ุงููููู",
                "ุงูุชุทุจูู": "ููู ุงููุฌูุฏ ูู ุฎูุงู ููู ูููุถู"
            },
            "ุงููุนุฑูุฉ": {
                "ุงูุชุนุฑูู": "ุงููุนุฑูุฉ ุดุจูุฉ ูู ุงููุชุงุฆู ุงููุชุฑุงุจุทุฉ ูู ูุถุงุก ูุชุนุงูุฏ",
                "ุงูููุธูุฑ_ุงูุซูุฑู": "ูู ูุนุฑูุฉ ุชุญุชุงุฌ ูุฌูู ูุชุนุงูุฏ ูุชูุชูู",
                "ุงูุชุทุจูู": "ุงูุชุนูู ูู ุฎูุงู ุงุณุชูุดุงู ุงููุฌููู"
            },
            "ุงูุญูููุฉ": {
                "ุงูุชุนุฑูู": "ุงูุญูููุฉ ูู ููุทุฉ ุงูุชูุงุฒู ุจูู ุฌููุน ุงูุฃุถุฏุงุฏ",
                "ุงูููุธูุฑ_ุงูุซูุฑู": "ูุง ุชูุฌุฏ ุญูููุฉ ูุทููุฉุ ุจู ุชูุงุฒู ุฏููุงูููู",
                "ุงูุชุทุจูู": "ุงูุจุญุซ ุนู ุงูุชูุงุฒู ุจุฏูุงู ูู ุงูุญูููุฉ ุงููุทููุฉ"
            }
        }
        
        # ุงูุนููู ุงูุซูุฑูุฉ
        self.knowledge_base["ุงูุนููู_ุงูุซูุฑูุฉ"] = {
            "ุงูููุฒูุงุก": {
                "ุงูุทุงูุฉ": "ุงูุทุงูุฉ ุชุชุจุน ูุธุฑูุฉ ุซูุงุฆูุฉ ุงูุตูุฑ - ููู ุทุงูุฉ ุทุงูุฉ ูุถุงุฏุฉ",
                "ุงูุญุฑูุฉ": "ุงูุญุฑูุฉ ุชุทุจู ุชุนุงูุฏ ุงูุฃุถุฏุงุฏ - ููู ุงุชุฌุงู ุงุชุฌุงู ูุชุนุงูุฏ",
                "ุงููุงุฏุฉ": "ุงููุงุฏุฉ ูุจููุฉ ูู ูุชุงุฆู ุฃูููุฉ ูุชุฑุงุจุทุฉ"
            },
            "ุงูููููุงุก": {
                "ุงูุชูุงุนูุงุช": "ุงูุชูุงุนูุงุช ุงูููููุงุฆูุฉ ุชุญูู ุชูุงุฒู ุซูุงุฆูุฉ ุงูุตูุฑ",
                "ุงูุฑูุงุจุท": "ุงูุฑูุงุจุท ุงูููููุงุฆูุฉ ุชุชุจุน ูุธุฑูุฉ ุงููุชุงุฆู",
                "ุงูุชูุงุฒู": "ุงูุชูุงุฒู ุงูููููุงุฆู ูุทุจู ุชุนุงูุฏ ุงูุฃุถุฏุงุฏ"
            },
            "ุงูุจููููุฌูุง": {
                "ุงูุญูุงุฉ": "ุงูุญูุงุฉ ุชูุงุฒู ุฏููุงูููู ุจูู ุงูุจูุงุก ูุงููุฏู",
                "ุงูุชุทูุฑ": "ุงูุชุทูุฑ ูุชุจุน ููุท ุงููุชุงุฆู ุงูุญูุฒูููุฉ",
                "ุงูุชููู": "ุงูุชููู ูุทุจู ุชุนุงูุฏ ุงูุฃุถุฏุงุฏ ูุน ุงูุจูุฆุฉ"
            }
        }
        
        # ุงูุฃุฏุจ ูุงูุดุนุฑ ุงูุซูุฑู
        self.knowledge_base["ุงูุฃุฏุจ_ุงูุซูุฑู"] = {
            "ูุตุงุฆุฏ_ุงููุธุฑูุงุช": {
                "ุซูุงุฆูุฉ_ุงูุตูุฑ": [
                    "ูู ูู ุดูุก ูููุถู ูุณูู",
                    "ูุงูุตูุฑ ูู ุงูุชูุงุฒู ุงูุฃููู",
                    "ููุง ุฒุงุฏ ููุง ููุต ููุงู",
                    "ููุง ููุต ููุง ุฒุงุฏ ูููู"
                ],
                "ุชุนุงูุฏ_ุงูุฃุถุฏุงุฏ": [
                    "ุงูุฃุถุฏุงุฏ ุชูุชูู ูู ุฒุงููุฉ ูุงุฆูุฉ",
                    "ูุง ุชุตุงุฑุน ุจู ุชูุงูู ุญููู",
                    "ูุงูููู ูุงูููุงุฑ ูุชุนุงูุฏุงู",
                    "ูููุงููุง ูููุฌูุฏ ูููู"
                ],
                "ุงููุชุงุฆู": [
                    "ูู ูุชูู ุตุบูุฑ ูุจุฏุฃ ุงูููู",
                    "ูุชุดุงุจู ูููุชู ุญูุฒูููุงู",
                    "ุญุชู ูุตูุฑ ุดุจูุฉ ุนุธููุฉ",
                    "ุชุฑุจุท ุงูุฃุดูุงุก ุชุฑุงุจุทุงู ููููุงู"
                ]
            }
        }
    
    def get_knowledge(self, topic: str, subtopic: str = None) -> Dict[str, Any]:
        """ุงุณุชุฑุฌุงุน ุงููุนุฑูุฉ ุญูู ููุถูุน ูุนูู"""
        
        if topic in self.knowledge_base:
            if subtopic and subtopic in self.knowledge_base[topic]:
                return {
                    "found": True,
                    "topic": topic,
                    "subtopic": subtopic,
                    "content": self.knowledge_base[topic][subtopic],
                    "source": "ูุงุนุฏุฉ ุงููุนุฑูุฉ ุงูุซูุฑูุฉ"
                }
            else:
                return {
                    "found": True,
                    "topic": topic,
                    "content": self.knowledge_base[topic],
                    "source": "ูุงุนุฏุฉ ุงููุนุฑูุฉ ุงูุซูุฑูุฉ"
                }
        else:
            return {
                "found": False,
                "message": f"ูู ูุชู ุงูุนุซูุฑ ุนูู ูุนุฑูุฉ ุญูู: {topic}",
                "suggestions": self._get_related_topics(topic)
            }
    
    def _get_related_topics(self, query: str) -> List[str]:
        """ุงูุชุฑุงุญ ููุงุถูุน ุฐุงุช ุตูุฉ"""
        
        suggestions = []
        query_lower = query.lower()
        
        for topic in self.knowledge_base.keys():
            if any(word in topic.lower() for word in query_lower.split()):
                suggestions.append(topic)
        
        return suggestions[:3]  # ุฃูุถู 3 ุงูุชุฑุงุญุงุช
    
    def search_knowledge(self, query: str) -> List[Dict[str, Any]]:
        """ุงูุจุญุซ ูู ูุงุนุฏุฉ ุงููุนุฑูุฉ ุงููุญููุฉ"""

        results = []

        # ุงูุจุญุซ ูู ุงููุนุฑูุฉ ุงููุญููุฉ
        query_words = query.lower().split()

        for topic, content in self.knowledge_base.items():
            # ุงูุจุญุซ ูู ุงูุนููุงู
            topic_score = sum(1 for word in query_words if word in topic.lower())

            # ุงูุจุญุซ ูู ุงููุญุชูู
            content_score = self._search_in_content(content, query_words)

            total_score = topic_score * 2 + content_score  # ุงูุนููุงู ูู ูุฒู ุฃูุจุฑ

            if total_score > 0:
                results.append({
                    "topic": topic,
                    "content": content,
                    "relevance_score": total_score,
                    "match_type": "ูุญูู",
                    "source": "ูุงุนุฏุฉ_ุงููุนุฑูุฉ_ุงููุญููุฉ"
                })

        # ุชุฑุชูุจ ุงููุชุงุฆุฌ ุญุณุจ ุงูุตูุฉ
        results.sort(key=lambda x: x["relevance_score"], reverse=True)

        return results[:8]  # ุฃูุถู 8 ูุชุงุฆุฌ
    
    def _search_in_content(self, content: Any, query_words: List[str]) -> int:
        """ุงูุจุญุซ ุฏุงุฎู ุงููุญุชูู"""
        
        score = 0
        content_str = str(content).lower()
        
        for word in query_words:
            score += content_str.count(word)
        
        return score




# ==========================================
# ๐งช ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงููุนุฑูุฉ
# ==========================================

def test_revolutionary_knowledge_base():
    """ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงููุนุฑูุฉ ุงูุซูุฑูุฉ"""
    
    print("๐งช ุจุฏุก ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงููุนุฑูุฉ ุงูุซูุฑูุฉ...")
    print("=" * 60)
    
    # ุฅูุดุงุก ูุงุนุฏุฉ ุงููุนุฑูุฉ
    kb = RevolutionaryKnowledgeBase()
    
    # ุงุฎุชุจุงุฑ ุงุณุชุฑุฌุงุน ุงููุนุฑูุฉ
    print("\n๐ ุงุฎุชุจุงุฑ ุงุณุชุฑุฌุงุน ุงููุนุฑูุฉ:")
    
    # ุงุฎุชุจุงุฑ ุงููุธุฑูุงุช ุงูุซูุฑูุฉ
    theories = kb.get_knowledge("ุงููุธุฑูุงุช_ุงูุซูุฑูุฉ", "ูุธุฑูุฉ_ุซูุงุฆูุฉ_ุงูุตูุฑ")
    if theories["found"]:
        print(f"โ ุชู ุงูุนุซูุฑ ุนูู: {theories['subtopic']}")
        print(f"๐ ุงูุชุนุฑูู: {theories['content']['ุงูุชุนุฑูู']}")
        print(f"๐ ุงููุนุงุฏูุฉ: {theories['content']['ุงููุนุงุฏูุฉ']}")
    
    # ุงุฎุชุจุงุฑ ุงูุจุญุซ
    print("\n๐ ุงุฎุชุจุงุฑ ุงูุจุญุซ:")
    search_results = kb.search_knowledge("ุซูุงุฆูุฉ ุงูุตูุฑ")
    print(f"๐ ุชู ุงูุนุซูุฑ ุนูู {len(search_results)} ูุชูุฌุฉ")
    
    for result in search_results[:2]:
        print(f"   โข {result['topic']} (ุตูุฉ: {result['relevance_score']})")
    
    print("\n๐ ุงูุชูู ุงุฎุชุจุงุฑ ูุงุนุฏุฉ ุงููุนุฑูุฉ ุจูุฌุงุญ!")
    
    return kb


if __name__ == "__main__":
    # ุชุดุบูู ุงูุงุฎุชุจุงุฑ
    knowledge_base = test_revolutionary_knowledge_base()
