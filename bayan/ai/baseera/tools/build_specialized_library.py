#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
๐งฌ ุจูุงุก ููุชุจุฉ ูุชุฎุตุตุฉ - ูุธุงู ุจุตูุฑุฉ ุงูุซูุฑู
===============================================

ูุฐุง ุงูุณูุฑูุจุช ูุณุงุนุฏ ูู ุจูุงุก ููุชุจุงุช ูุนุฑููุฉ ูุชุฎุตุตุฉ ูู ูุฌุงูุงุช ูุญุฏุฏุฉ
ุจุงุณุชุฎุฏุงู ูุธุงู ุจุตูุฑุฉ ุงูุซูุฑู ูุน ุชูุงูู Ollama.

ุงูุงุณุชุฎุฏุงู:
    python3 build_specialized_library.py

ุงููุทูุฑ: ุจุงุณู ูุญูู ุนุจุฏุงููู
"""

from revolutionary_knowledge_system import RevolutionaryKnowledgeSystem
import time
import sys
from datetime import datetime

class SpecializedLibraryBuilder:
    """ุจูุงุก ููุชุจุงุช ูุนุฑููุฉ ูุชุฎุตุตุฉ"""
    
    def __init__(self):
        """ุชููุฆุฉ ุงูุจูุงุก"""
        print("๐งฌ ุชููุฆุฉ ุจูุงุก ุงูููุชุจุฉ ุงููุชุฎุตุตุฉ...")
        self.system = RevolutionaryKnowledgeSystem()
        self.successful = 0
        self.failed = 0
        self.start_time = datetime.now()
    
    def build_ai_library(self):
        """ุจูุงุก ููุชุจุฉ ูุชุฎุตุตุฉ ูู ุงูุฐูุงุก ุงูุงุตุทูุงุนู"""
        ai_topics = [
            "ุชุงุฑูุฎ ุงูุฐูุงุก ุงูุงุตุทูุงุนู ููุฑุงุญู ุชุทูุฑู",
            "ุฃููุงุน ุฎูุงุฑุฒููุงุช ุงูุชุนูู ุงูุขูู ูุงูุชุทุจููุงุช",
            "ุงูุดุจูุงุช ุงูุนุตุจูุฉ ุงูุนูููุฉ ูุงูุชุทุจููุงุช ุงูุนูููุฉ", 
            "ูุนุงูุฌุฉ ุงูุตูุฑ ูุงูุฑุคูุฉ ุงูุญุงุณูุจูุฉ",
            "ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุงูุทุจ ูุงูุชุดุฎูุต",
            "ุฃุฎูุงููุงุช ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุงููุณุคูููุฉ",
            "ูุณุชูุจู ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูุงูุชููุนุงุช",
            "ุงูุชุนูู ุงููุนุฒุฒ ูุงูุฃูุนุงุจ ุงูุฐููุฉ",
            "ูุนุงูุฌุฉ ุงููุบุฉ ุงูุนุฑุจูุฉ ุงูุทุจูุนูุฉ",
            "ุงูุฑุคูุฉ ุงูุญุงุณูุจูุฉ ูุงูุชุนุฑู ุนูู ุงูุฃููุงุท",
            "ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุงูุฑูุจูุชุงุช",
            "ุงูุชุนูู ุบูุฑ ุงููุฑุงูุจ ูุงูุชุดุงู ุงูุฃููุงุท",
            "ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุงูุชุฌุงุฑุฉ ุงูุฅููุชุฑูููุฉ",
            "ุฃูุธูุฉ ุงูุชูุตูุฉ ุงูุฐููุฉ",
            "ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุงูุฃูู ุงูุณูุจุฑุงูู"
        ]
        
        return self._build_library("ุงูุฐูุงุก ุงูุงุตุทูุงุนู", ai_topics)
    
    def build_programming_library(self):
        """ุจูุงุก ููุชุจุฉ ูุชุฎุตุตุฉ ูู ุงูุจุฑูุฌุฉ"""
        programming_topics = [
            "ุฃุณุงุณูุงุช ุงูุจุฑูุฌุฉ ูุงูุฎูุงุฑุฒููุงุช",
            "ูุบุงุช ุงูุจุฑูุฌุฉ ุงูุญุฏูุซุฉ ูููุงุฑูุฉ ุจูููุง",
            "ููุงูู ุงูุจูุงูุงุช ูุงูุฎูุงุฑุฒููุงุช ุงููุชูุฏูุฉ",
            "ุงูุจุฑูุฌุฉ ุงููุงุฆููุฉ ูุงูุชุตููู",
            "ููุงุนุฏ ุงูุจูุงูุงุช ูุฅุฏุงุฑุฉ ุงููุนูููุงุช",
            "ุชุทููุฑ ุงูููุจ ูุงูุชูููุงุช ุงูุญุฏูุซุฉ",
            "ุงูุจุฑูุฌุฉ ุงููุชูุงุฒูุฉ ูุงููุนุงูุฌุฉ ุงููุชุนุฏุฏุฉ",
            "ุฃูู ุงูุจุฑูุฌูุงุช ูุฃูุถู ุงูููุงุฑุณุงุช",
            "ุงุฎุชุจุงุฑ ุงูุจุฑูุฌูุงุช ูุถูุงู ุงูุฌูุฏุฉ",
            "ุฅุฏุงุฑุฉ ุงููุดุงุฑูุน ุงูุจุฑูุฌูุฉ",
            "ุงูุจุฑูุฌุฉ ุงููุธูููุฉ ูุงูููุงุฐุฌ ุงููุฎุชููุฉ",
            "ุชุทููุฑ ุงูุชุทุจููุงุช ุงููุญูููุฉ",
            "ุงูุญูุณุจุฉ ุงูุณุญุงุจูุฉ ูุงูุฎุฏูุงุช",
            "DevOps ูุงูุชุทููุฑ ุงููุณุชูุฑ",
            "ุงูุฐูุงุก ุงูุงุตุทูุงุนู ูู ุงูุจุฑูุฌุฉ"
        ]
        
        return self._build_library("ุงูุจุฑูุฌุฉ", programming_topics)
    
    def build_science_library(self):
        """ุจูุงุก ููุชุจุฉ ูุชุฎุตุตุฉ ูู ุงูุนููู"""
        science_topics = [
            "ุงูููุฒูุงุก ุงููููุฉ ูุงููููุงูููุง ุงููููุฉ",
            "ุงูููููุงุก ุงูุนุถููุฉ ูุงูุชูุงุนูุงุช",
            "ุนูู ุงูุฃุญูุงุก ุงูุฌุฒูุฆู ูุงูุฎูุงูุง",
            "ุงูุฑูุงุถูุงุช ุงูุชุทุจูููุฉ ูุงููุธุฑูุฉ",
            "ุนูู ุงูููู ูุงุณุชูุดุงู ุงููุถุงุก",
            "ุงูุฌููููุฌูุง ูุนููู ุงูุฃุฑุถ",
            "ุงูุจูุฆุฉ ูุงูุชุบูุฑ ุงูููุงุฎู",
            "ุงูุทุงูุฉ ุงููุชุฌุฏุฏุฉ ูุงูุงุณุชุฏุงูุฉ",
            "ุงููุงููุชูููููุฌู ูุงูููุงุฏ ุงููุชูุฏูุฉ",
            "ุงูููุฏุณุฉ ุงููุฑุงุซูุฉ ูุงูุชูููููุฌูุง ุงูุญูููุฉ",
            "ุนูู ุงูููุณ ุงููุนุฑูู ูุงูุณูููู",
            "ุงูุฅุญุตุงุก ูุงูุชุญููู ุงูุฑูุงุถู",
            "ุงูููุฒูุงุก ุงููุธุฑูุฉ ูุงููุณุจูุฉ",
            "ุงูููููุงุก ุงูุชุญููููุฉ ูุงูููุงุณุงุช",
            "ุนููู ุงูุญุงุณูุจ ุงููุธุฑูุฉ"
        ]
        
        return self._build_library("ุงูุนููู", science_topics)
    
    def build_arabic_language_library(self):
        """ุจูุงุก ููุชุจุฉ ูุชุฎุตุตุฉ ูู ุงููุบุฉ ุงูุนุฑุจูุฉ"""
        arabic_topics = [
            "ููุงุนุฏ ุงููุญู ุงูุนุฑุจู ูุงูุฅุนุฑุงุจ",
            "ุนูู ุงูุตุฑู ูุงูุงุดุชูุงู ูู ุงูุนุฑุจูุฉ",
            "ุงูุจูุงุบุฉ ุงูุนุฑุจูุฉ ูุงูุฃุณุงููุจ ุงูุจูุงููุฉ",
            "ุงูุฃุฏุจ ุงูุนุฑุจู ุนุจุฑ ุงูุนุตูุฑ",
            "ุงูุดุนุฑ ุงูุนุฑุจู ูุงูุฃูุฒุงู ูุงูููุงูู",
            "ููู ุงููุบุฉ ุงูุนุฑุจูุฉ ูุงูุชุทูุฑ ุงูุชุงุฑูุฎู",
            "ุงููุนุงุฌู ุงูุนุฑุจูุฉ ูุนูู ุงููุนุฌู",
            "ุงูููุฌุงุช ุงูุนุฑุจูุฉ ูุงูุชููุน ุงููุบูู",
            "ุงูุชุฑุฌูุฉ ูู ูุฅูู ุงูุนุฑุจูุฉ",
            "ุชุนููู ุงูุนุฑุจูุฉ ูููุงุทููู ุจุบูุฑูุง",
            "ุงูุฎุท ุงูุนุฑุจู ูุงููุชุงุจุฉ",
            "ุงูุฅุนูุงู ุงูุนุฑุจู ูุงููุบุฉ",
            "ุงูุชูููููุฌูุง ูุงููุบุฉ ุงูุนุฑุจูุฉ",
            "ุงููุณุงููุงุช ุงูุนุฑุจูุฉ ุงูุญุฏูุซุฉ",
            "ุงูุชุฑุงุซ ุงูุนุฑุจู ูุงููุฎุทูุทุงุช"
        ]
        
        return self._build_library("ุงููุบุฉ ุงูุนุฑุจูุฉ", arabic_topics)
    
    def _build_library(self, library_name: str, topics: list) -> dict:
        """ุจูุงุก ููุชุจุฉ ูุนุฑููุฉ ูุชุฎุตุตุฉ"""
        print(f"\n๐ฏ ุจูุงุก ููุชุจุฉ {library_name}")
        print(f"๐ ุนุฏุฏ ุงูููุงุถูุน: {len(topics)}")
        print("=" * 50)
        
        local_successful = 0
        local_failed = 0
        
        for i, topic in enumerate(topics, 1):
            print(f"๐ ({i:2d}/{len(topics)}) {topic}")
            
            try:
                result = self.system.extract_from_external_source('ollama', topic)
                if result and len(result.strip()) > 50:  # ุงูุชุฃูุฏ ูู ุฌูุฏุฉ ุงููุญุชูู
                    local_successful += 1
                    self.successful += 1
                    print(f"โ ุชู ุจูุฌุงุญ ({len(result)} ุญุฑู)")
                else:
                    local_failed += 1
                    self.failed += 1
                    print(f"โ ูุดู ุฃู ูุญุชูู ุถุนูู")
                
                # ุชููู ูุตูุฑ ูุชุฌูุจ ุฅุฑูุงู ุงููุธุงู
                time.sleep(3)
                
            except Exception as e:
                local_failed += 1
                self.failed += 1
                print(f"โ ุฎุทุฃ: {str(e)[:50]}...")
                time.sleep(1)
        
        # ุฅุญุตุงุฆูุงุช ุงูููุชุจุฉ
        success_rate = (local_successful / len(topics)) * 100
        
        print(f"\n๐ ูุชุงุฆุฌ ููุชุจุฉ {library_name}:")
        print(f"โ ูุฌุญ: {local_successful}")
        print(f"โ ูุดู: {local_failed}")
        print(f"๐ ูุนุฏู ุงููุฌุงุญ: {success_rate:.1f}%")
        
        return {
            'name': library_name,
            'total': len(topics),
            'successful': local_successful,
            'failed': local_failed,
            'success_rate': success_rate
        }
    
    def build_all_libraries(self):
        """ุจูุงุก ุฌููุน ุงูููุชุจุงุช ุงููุชุฎุตุตุฉ"""
        print("๐ ุจุฏุก ุจูุงุก ุฌููุน ุงูููุชุจุงุช ุงููุชุฎุตุตุฉ...")
        print(f"โฐ ููุช ุงูุจุฏุก: {self.start_time.strftime('%Y-%m-%d %H:%M:%S')}")
        
        libraries = []
        
        try:
            # ุจูุงุก ุงูููุชุจุงุช ูุงุญุฏุฉ ุชูู ุงูุฃุฎุฑู
            libraries.append(self.build_ai_library())
            libraries.append(self.build_programming_library())
            libraries.append(self.build_science_library())
            libraries.append(self.build_arabic_language_library())
            
        except KeyboardInterrupt:
            print("\nโ๏ธ ุชู ุฅููุงู ุงูุนูููุฉ ุจูุงุณุทุฉ ุงููุณุชุฎุฏู")
        except Exception as e:
            print(f"\nโ ุฎุทุฃ ุนุงู: {e}")
        
        # ุงูุชูุฑูุฑ ุงูููุงุฆู
        self._generate_final_report(libraries)
    
    def _generate_final_report(self, libraries: list):
        """ุฅูุชุงุฌ ุงูุชูุฑูุฑ ุงูููุงุฆู"""
        end_time = datetime.now()
        duration = end_time - self.start_time
        
        print("\n" + "="*60)
        print("๐ ุงูุชูุฑูุฑ ุงูููุงุฆู ูุจูุงุก ุงูููุชุจุงุช ุงููุชุฎุตุตุฉ")
        print("="*60)
        
        print(f"โฐ ููุช ุงูุจุฏุก: {self.start_time.strftime('%Y-%m-%d %H:%M:%S')}")
        print(f"โฐ ููุช ุงูุงูุชูุงุก: {end_time.strftime('%Y-%m-%d %H:%M:%S')}")
        print(f"โฑ๏ธ ุงููุฏุฉ ุงูุฅุฌูุงููุฉ: {duration}")
        
        print(f"\n๐ ุงูุฅุญุตุงุฆูุงุช ุงูุฅุฌูุงููุฉ:")
        print(f"โ ุฅุฌูุงูู ุงููุฌุงุญ: {self.successful}")
        print(f"โ ุฅุฌูุงูู ุงููุดู: {self.failed}")
        
        if self.successful + self.failed > 0:
            overall_success = (self.successful / (self.successful + self.failed)) * 100
            print(f"๐ ูุนุฏู ุงููุฌุงุญ ุงูุฅุฌูุงูู: {overall_success:.1f}%")
        
        print(f"\n๐ ุชูุงุตูู ุงูููุชุจุงุช:")
        for lib in libraries:
            print(f"  ๐ {lib['name']}:")
            print(f"    โ ูุฌุญ: {lib['successful']}/{lib['total']} ({lib['success_rate']:.1f}%)")
        
        # ุชูููู ุงูุฌูุฏุฉ
        if overall_success >= 80:
            print(f"\n๐ ููุชุงุฒ! ุชู ุจูุงุก ููุชุจุฉ ูุนุฑููุฉ ุนุงููุฉ ุงูุฌูุฏุฉ")
        elif overall_success >= 60:
            print(f"\n๐ ุฌูุฏ! ููุชุจุฉ ูุนุฑููุฉ ููุจููุฉ ูุน ุฅููุงููุฉ ุงูุชุญุณูู")
        else:
            print(f"\nโ๏ธ ูุญุชุงุฌ ุชุญุณูู! ุฑุงุฌุน ุฅุนุฏุงุฏุงุช ุงููุธุงู ูุงูุงุชุตุงู")
        
        print(f"\n๐ฏ ุงูุฎุทูุงุช ุงูุชุงููุฉ:")
        print(f"  1. ุงุฎุชุจุงุฑ ุงูุจุญุซ ูู ุงููุนุฑูุฉ ุงูุฌุฏูุฏุฉ")
        print(f"  2. ูุฑุงุฌุนุฉ ุฌูุฏุฉ ุงููุญุชูู ุงููุณุชุฎุฑุฌ")
        print(f"  3. ุฅุถุงูุฉ ููุงุถูุน ุฅุถุงููุฉ ุญุณุจ ุงูุญุงุฌุฉ")
        print(f"  4. ุชุทููุฑ ูุธุงู ุชูููู ุฌูุฏุฉ ุงููุนุฑูุฉ")

def main():
    """ุงูุฏุงูุฉ ุงูุฑุฆูุณูุฉ"""
    print("๐งฌ ูุฑุญุจุงู ุจู ูู ุจูุงุก ุงูููุชุจุงุช ุงููุชุฎุตุตุฉ!")
    print("ูุฐุง ุงูุณูุฑูุจุช ุณูุจูู ููุชุจุงุช ูุนุฑููุฉ ูุชุฎุตุตุฉ ูู:")
    print("  1. ุงูุฐูุงุก ุงูุงุตุทูุงุนู")
    print("  2. ุงูุจุฑูุฌุฉ")
    print("  3. ุงูุนููู")
    print("  4. ุงููุบุฉ ุงูุนุฑุจูุฉ")
    print()
    
    response = input("ูู ุชุฑูุฏ ุงููุชุงุจุนุฉุ (y/n): ").lower().strip()
    if response not in ['y', 'yes', 'ูุนู', 'ู']:
        print("ุชู ุงูุฅูุบุงุก.")
        return
    
    builder = SpecializedLibraryBuilder()
    builder.build_all_libraries()

if __name__ == "__main__":
    main()
